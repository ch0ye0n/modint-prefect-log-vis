timestamp,level,flow_run_id,task_run_id,message
2025-10-23 06:07:06.329069+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,Worker 'KubernetesWorker a05e490e-9eac-4523-9166-1b04920e6d58' submitting flow run 'c63c78cd-ba19-47a2-bbcb-b11a2983983d'
2025-10-23 06:07:06.532176+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,Creating Kubernetes job...
2025-10-23 06:07:06.833893+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,Completed submission of flow run 'c63c78cd-ba19-47a2-bbcb-b11a2983983d'
2025-10-23 06:07:13.266054+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,Opening process...
2025-10-23 06:07:15.901184+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,, > Running git_clone step...
2025-10-23 06:07:21.577252+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,Beginning flow run 'phi6-gruis-p' for flow 'run-modint-flow'
2025-10-23 06:07:21.731262+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d40f-7554-b69c-070a69ecc848,This job ID will be used - modint-prefect-phi6-gruis-p-1
2025-10-23 06:07:21.737745+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d40f-7554-b69c-070a69ecc848,Finished in state Completed()
2025-10-23 06:07:22.235335+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48c-7759-8c6d-85f015d357de,Finished in state Completed()
2025-10-23 06:07:22.276034+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48f-7621-8ca0-adc50ec1bb0d,{'scene_path': '/nas/Dataset/securewatch/geofocus/20231213_mcp_Pyongyang/017253722020_01/017253722020_01_P001_PSH/23NOV04024144-S2AS_R1C2-017253722020_01_P001.TIF'}
2025-10-23 06:07:22.389086+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d6f5-71df-8a53-f924317ac8b5,Finished in state Completed()
2025-10-23 06:07:23.529868+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,Beginning subflow run 'tunneling-rooster' for flow 'run-namespaced-job'
2025-10-23 06:07:30.890204+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"Downloading artifacts:   0%|          | 0/13 [00:00<?, ?it/s]2025/10/23 06:07:30 INFO mlflow.store.artifact.artifact_repo: The progress bar can be disabled by setting the environment variable MLFLOW_ENABLE_ARTIFACTS_PROGRESS_BAR to false
"
2025-10-23 06:08:05.217213+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"Downloading artifacts:   8%|â–Š         | 1/13 [00:00<00:00, 100.88it/s]Downloading artifacts:  15%|â–ˆâ–Œ        | 2/13 [00:00<00:00, 132.74it/s]Downloading artifacts:  23%|â–ˆâ–ˆâ–Ž       | 3/13 [00:00<00:00, 194.80it/s]Downloading artifacts:  31%|â–ˆâ–ˆâ–ˆ       | 4/13 [00:00<00:00, 255.88it/s]Downloading artifacts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 5/13 [00:00<00:00, 177.75it/s]Downloading artifacts:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 6/13 [00:00<00:00, 185.82it/s]Downloading artifacts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 7/13 [00:00<00:00, 139.20it/s]Downloading artifacts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 8/13 [00:00<00:00, 158.03it/s]Downloading artifacts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 9/13 [00:00<00:00, 165.12it/s]Downloading artifacts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 10/13 [00:00<00:00, 146.18it/s]Downloading artifacts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 97.91it/s] Downloading artifacts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 97.91it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 97.91it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00, 97.91it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00,  1.15s/it]
"
2025-10-23 06:08:05.221261+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"Loads checkpoint by local backend from path: /tmp/tmpjnp05x8f/checkpoint/model_final.pth
"
2025-10-23 06:08:06.529800+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"Making patches:   0%|          | 0/1 [00:00<?, ?it/s]Making patches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 7839.82it/s]
"
2025-10-23 06:08:08.293828+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"2025-10-23 06:08:08.272 | ERROR    | modint.runner.base_runner:inference:137 - An exception occurred:
"
2025-10-23 06:08:08.296343+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"Traceback (most recent call last):
"
2025-10-23 06:08:08.298304+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 06:08:08.300949+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    result = self.predict(data)
"
2025-10-23 06:08:08.302751+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 06:08:08.304810+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    return func(*args, **kwargs)
"
2025-10-23 06:08:08.306538+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 06:08:08.312374+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    return self.model.test_step(batch)
"
2025-10-23 06:08:08.313942+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 06:08:08.315628+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 06:08:08.317542+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 06:08:08.319426+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    results = self(**data, mode=mode)
"
2025-10-23 06:08:08.321119+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 06:08:08.323052+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    return forward_call(*input, **kwargs)
"
2025-10-23 06:08:08.324975+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 06:08:08.326351+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    return self.predict(inputs, data_samples)
"
2025-10-23 06:08:08.327483+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 06:08:08.328634+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 06:08:08.330119+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 06:08:08.331573+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    x = self.backbone(batch_inputs)
"
2025-10-23 06:08:08.332941+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 06:08:08.334513+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    return forward_call(*input, **kwargs)
"
2025-10-23 06:08:08.335590+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 06:08:08.336655+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    x = blk(x)
"
2025-10-23 06:08:08.337857+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 06:08:08.338966+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    return forward_call(*input, **kwargs)
"
2025-10-23 06:08:08.339996+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 06:08:08.341198+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    x = self.attn(x)
"
2025-10-23 06:08:08.342268+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 06:08:08.343267+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    return forward_call(*input, **kwargs)
"
2025-10-23 06:08:08.344490+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 06:08:08.345394+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 06:08:08.346488+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 06:08:08.347191+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 06:08:08.348461+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 06:08:08.349379+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"
"
2025-10-23 06:08:08.350057+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"[32m2025-10-23T06:08:08.272289+0000[0m [31m[1mAn exception occurred:
"
2025-10-23 06:08:08.350744+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"Traceback (most recent call last):
"
2025-10-23 06:08:08.351411+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 06:08:08.352111+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    result = self.predict(data)
"
2025-10-23 06:08:08.352782+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 06:08:08.353466+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    return func(*args, **kwargs)
"
2025-10-23 06:08:08.354123+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 06:08:08.354713+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    return self.model.test_step(batch)
"
2025-10-23 06:08:08.355283+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 06:08:08.355887+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 06:08:08.356463+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 06:08:08.357044+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    results = self(**data, mode=mode)
"
2025-10-23 06:08:08.357609+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 06:08:08.358181+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    return forward_call(*input, **kwargs)
"
2025-10-23 06:08:08.358750+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 06:08:08.359333+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    return self.predict(inputs, data_samples)
"
2025-10-23 06:08:08.359911+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 06:08:08.360491+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 06:08:08.361058+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 06:08:08.361820+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    x = self.backbone(batch_inputs)
"
2025-10-23 06:08:08.362391+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 06:08:08.362960+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    return forward_call(*input, **kwargs)
"
2025-10-23 06:08:08.363516+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 06:08:08.364108+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    x = blk(x)
"
2025-10-23 06:08:08.364676+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 06:08:08.365267+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    return forward_call(*input, **kwargs)
"
2025-10-23 06:08:08.365895+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 06:08:08.366479+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    x = self.attn(x)
"
2025-10-23 06:08:08.367038+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 06:08:08.367602+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    return forward_call(*input, **kwargs)
"
2025-10-23 06:08:08.368605+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 06:08:08.369362+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 06:08:08.370087+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 06:08:08.371042+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 06:08:08.371799+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 06:08:08.372544+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,"[0m
"
2025-10-23 06:08:15.576697+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48d-70b8-9dbe-ad25de41b617,Finished in state Completed()
2025-10-23 06:08:22.346326+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48f-7621-8ca0-adc50ec1bb0d,"{'msg': 'Traceback (most recent call last):\n  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference\n    result = self.predict(data)\n  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context\n    return func(*args, **kwargs)\n  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict\n    return self.model.test_step(batch)\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step\n    return self._run_forward(data, mode=\'predict\')  # type: ignore\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward\n    results = self(**data, mode=mode)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward\n    return self.predict(inputs, data_samples)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict\n    x = self.extract_feat(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat\n    x = self.backbone(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward\n    x = blk(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward\n    x = self.attn(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward\n    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos\n    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504\nRuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)\n', 'retriable': False}"
2025-10-23 06:08:22.352787+00:00,40,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48f-7621-8ca0-adc50ec1bb0d,Inference was failed. See the logs for detail.
2025-10-23 06:08:22.354892+00:00,40,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48f-7621-8ca0-adc50ec1bb0d,"Task run failed with exception: InferenceFailError() - No retries configured for this task.
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 06:08:22.371594+00:00,40,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a0fad-d48f-7621-8ca0-adc50ec1bb0d,Finished in state Failed('Task run encountered an exception InferenceFailError: ')
2025-10-23 06:08:22.381670+00:00,40,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,"Encountered exception during execution: InferenceFailError()
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 06:08:22.441469+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,Finished in state Failed('Flow run encountered an exception: InferenceFailError: ')
2025-10-23 06:08:22.444264+00:00,40,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,"Engine execution exited with unexpected exception
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1554, in run_flow
    ret_val = run_flow_sync(**kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1399, in run_flow_sync
    return engine.state if return_type == ""state"" else engine.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 361, in result
    raise self._raised
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 06:08:23.106316+00:00,40,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,Process for flow run 'phi6-gruis-p' exited with status code: 1
2025-10-23 08:52:47.023864+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,Worker 'KubernetesWorker a05e490e-9eac-4523-9166-1b04920e6d58' submitting flow run 'c63c78cd-ba19-47a2-bbcb-b11a2983983d'
2025-10-23 08:52:47.211570+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,Creating Kubernetes job...
2025-10-23 08:52:47.406985+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,Completed submission of flow run 'c63c78cd-ba19-47a2-bbcb-b11a2983983d'
2025-10-23 08:52:54.311161+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,Opening process...
2025-10-23 08:52:57.062158+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,, > Running git_clone step...
2025-10-23 08:53:02.767091+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,Beginning flow run 'phi6-gruis-p' for flow 'run-modint-flow'
2025-10-23 08:53:02.922903+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-84d3-79a0-9a96-523bcd2ae6bc,This job ID will be used - modint-prefect-phi6-gruis-p-2
2025-10-23 08:53:02.928782+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-84d3-79a0-9a96-523bcd2ae6bc,Finished in state Completed()
2025-10-23 08:53:03.466229+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-784c-b5bd-c01e639b5977,Finished in state Completed()
2025-10-23 08:53:03.527845+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8556-713c-89ac-446038638283,{'scene_path': '/nas/Dataset/securewatch/geofocus/20231213_mcp_Pyongyang/017253722020_01/017253722020_01_P001_PSH/23NOV04024144-S2AS_R1C2-017253722020_01_P001.TIF'}
2025-10-23 08:53:03.629420+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-87d5-7480-9f28-553a335b0a02,Finished in state Completed()
2025-10-23 08:53:04.385862+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,Beginning subflow run 'tunneling-rooster' for flow 'run-namespaced-job'
2025-10-23 08:53:11.788198+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"Downloading artifacts:   0%|          | 0/13 [00:00<?, ?it/s]2025/10/23 08:53:11 INFO mlflow.store.artifact.artifact_repo: The progress bar can be disabled by setting the environment variable MLFLOW_ENABLE_ARTIFACTS_PROGRESS_BAR to false
"
2025-10-23 08:53:47.473186+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"Loads checkpoint by local backend from path: /tmp/tmps3bkxba4/checkpoint/model_final.pth
"
2025-10-23 08:53:47.475438+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"Downloading artifacts:   8%|â–Š         | 1/13 [00:00<00:00, 1754.94it/s]Downloading artifacts:  15%|â–ˆâ–Œ        | 2/13 [00:00<00:00, 2334.06it/s]Downloading artifacts:  23%|â–ˆâ–ˆâ–Ž       | 3/13 [00:00<00:00, 2764.87it/s]Downloading artifacts:  31%|â–ˆâ–ˆâ–ˆ       | 4/13 [00:00<00:00, 3078.39it/s]Downloading artifacts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 5/13 [00:00<00:00, 1287.70it/s]Downloading artifacts:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 6/13 [00:00<00:00, 636.43it/s] Downloading artifacts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 7/13 [00:00<00:00, 462.10it/s]Downloading artifacts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 8/13 [00:00<00:00, 481.32it/s]Downloading artifacts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 9/13 [00:00<00:00, 152.39it/s]Downloading artifacts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 10/13 [00:00<00:00, 151.21it/s]Downloading artifacts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 151.09it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 90.76it/s] Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 90.76it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:15<00:00, 90.76it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:15<00:00,  1.19s/it]
"
2025-10-23 08:53:48.667567+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"Making patches:   0%|          | 0/1 [00:00<?, ?it/s]Making patches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 11491.24it/s]
"
2025-10-23 08:53:50.395286+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"2025-10-23 08:53:50.398 | ERROR    | modint.runner.base_runner:inference:137 - An exception occurred:
"
2025-10-23 08:53:50.397643+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"Traceback (most recent call last):
"
2025-10-23 08:53:50.399492+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 08:53:50.401625+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    result = self.predict(data)
"
2025-10-23 08:53:50.403466+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 08:53:50.405261+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    return func(*args, **kwargs)
"
2025-10-23 08:53:50.411026+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 08:53:50.412835+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    return self.model.test_step(batch)
"
2025-10-23 08:53:50.414634+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 08:53:50.416857+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 08:53:50.418687+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 08:53:50.420523+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    results = self(**data, mode=mode)
"
2025-10-23 08:53:50.422681+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 08:53:50.424186+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    return forward_call(*input, **kwargs)
"
2025-10-23 08:53:50.425615+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 08:53:50.427452+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    return self.predict(inputs, data_samples)
"
2025-10-23 08:53:50.428929+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 08:53:50.430382+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 08:53:50.432214+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 08:53:50.433572+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    x = self.backbone(batch_inputs)
"
2025-10-23 08:53:50.434772+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 08:53:50.436426+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    return forward_call(*input, **kwargs)
"
2025-10-23 08:53:50.437684+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 08:53:50.438897+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    x = blk(x)
"
2025-10-23 08:53:50.440506+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 08:53:50.441762+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    return forward_call(*input, **kwargs)
"
2025-10-23 08:53:50.442952+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 08:53:50.444417+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    x = self.attn(x)
"
2025-10-23 08:53:50.445514+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 08:53:50.446584+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    return forward_call(*input, **kwargs)
"
2025-10-23 08:53:50.448065+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 08:53:50.449193+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 08:53:50.450180+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 08:53:50.451876+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 08:53:50.452985+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 08:53:50.454341+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"
"
2025-10-23 08:53:50.455336+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"[32m2025-10-23T08:53:50.398153+0000[0m [31m[1mAn exception occurred:
"
2025-10-23 08:53:50.456328+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"Traceback (most recent call last):
"
2025-10-23 08:53:50.457630+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 08:53:50.458655+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    result = self.predict(data)
"
2025-10-23 08:53:50.459634+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 08:53:50.460965+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    return func(*args, **kwargs)
"
2025-10-23 08:53:50.461997+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 08:53:50.462968+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    return self.model.test_step(batch)
"
2025-10-23 08:53:50.463655+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 08:53:50.464361+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 08:53:50.465042+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 08:53:50.465726+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    results = self(**data, mode=mode)
"
2025-10-23 08:53:50.466394+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 08:53:50.467078+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    return forward_call(*input, **kwargs)
"
2025-10-23 08:53:50.467761+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 08:53:50.468992+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    return self.predict(inputs, data_samples)
"
2025-10-23 08:53:50.469908+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 08:53:50.470788+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 08:53:50.473877+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 08:53:50.474745+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    x = self.backbone(batch_inputs)
"
2025-10-23 08:53:50.475331+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 08:53:50.475943+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    return forward_call(*input, **kwargs)
"
2025-10-23 08:53:50.476518+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 08:53:50.477092+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    x = blk(x)
"
2025-10-23 08:53:50.477646+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 08:53:50.478221+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    return forward_call(*input, **kwargs)
"
2025-10-23 08:53:50.478785+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 08:53:50.479370+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    x = self.attn(x)
"
2025-10-23 08:53:50.522892+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 08:53:50.524288+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    return forward_call(*input, **kwargs)
"
2025-10-23 08:53:50.525353+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 08:53:50.526413+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 08:53:50.527466+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 08:53:50.529170+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 08:53:50.530685+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 08:53:50.532110+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,"[0m
"
2025-10-23 08:53:57.670362+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8554-7ab4-9e37-46a76d329bb1,Finished in state Completed()
2025-10-23 08:54:03.601525+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8556-713c-89ac-446038638283,"{'msg': 'Traceback (most recent call last):\n  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference\n    result = self.predict(data)\n  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context\n    return func(*args, **kwargs)\n  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict\n    return self.model.test_step(batch)\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step\n    return self._run_forward(data, mode=\'predict\')  # type: ignore\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward\n    results = self(**data, mode=mode)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward\n    return self.predict(inputs, data_samples)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict\n    x = self.extract_feat(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat\n    x = self.backbone(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward\n    x = blk(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward\n    x = self.attn(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward\n    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos\n    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504\nRuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)\n', 'retriable': False}"
2025-10-23 08:54:03.607458+00:00,40,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8556-713c-89ac-446038638283,Inference was failed. See the logs for detail.
2025-10-23 08:54:03.609605+00:00,40,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8556-713c-89ac-446038638283,"Task run failed with exception: InferenceFailError() - No retries configured for this task.
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 08:54:03.622995+00:00,40,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a1045-8556-713c-89ac-446038638283,Finished in state Failed('Task run encountered an exception InferenceFailError: ')
2025-10-23 08:54:03.631023+00:00,40,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,"Encountered exception during execution: InferenceFailError()
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 08:54:03.682438+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,Finished in state Failed('Flow run encountered an exception: InferenceFailError: ')
2025-10-23 08:54:03.685241+00:00,40,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,"Engine execution exited with unexpected exception
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1554, in run_flow
    ret_val = run_flow_sync(**kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1399, in run_flow_sync
    return engine.state if return_type == ""state"" else engine.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 361, in result
    raise self._raised
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 08:54:04.270982+00:00,40,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,Process for flow run 'phi6-gruis-p' exited with status code: 1
2025-10-23 09:32:58.441904+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,Worker 'KubernetesWorker a05e490e-9eac-4523-9166-1b04920e6d58' submitting flow run 'c63c78cd-ba19-47a2-bbcb-b11a2983983d'
2025-10-23 09:32:58.603282+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,Creating Kubernetes job...
2025-10-23 09:32:58.778244+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,Completed submission of flow run 'c63c78cd-ba19-47a2-bbcb-b11a2983983d'
2025-10-23 09:33:05.738860+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,Opening process...
2025-10-23 09:33:08.528421+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,, > Running git_clone step...
2025-10-23 09:33:14.689443+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,Beginning flow run 'phi6-gruis-p' for flow 'run-modint-flow'
2025-10-23 09:33:14.837464+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-5265-70e2-bb0e-1885cd656cff,This job ID will be used - modint-prefect-phi6-gruis-p-3
2025-10-23 09:33:14.843751+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-5265-70e2-bb0e-1885cd656cff,Finished in state Completed()
2025-10-23 09:33:15.364960+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7f9b-b340-dcf37fdc7f84,Finished in state Completed()
2025-10-23 09:33:15.409860+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52e3-75a6-a4e0-770d55c7d6b0,{'scene_path': '/nas/Dataset/securewatch/geofocus/20231213_mcp_Pyongyang/017253722020_01/017253722020_01_P001_PSH/23NOV04024144-S2AS_R1C2-017253722020_01_P001.TIF'}
2025-10-23 09:33:15.507467+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-5550-7527-adf9-cddf5029f45d,Finished in state Completed()
2025-10-23 09:33:16.922921+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,Beginning subflow run 'tunneling-rooster' for flow 'run-namespaced-job'
2025-10-23 09:33:24.630216+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"Downloading artifacts:   0%|          | 0/13 [00:00<?, ?it/s]2025/10/23 09:33:24 INFO mlflow.store.artifact.artifact_repo: The progress bar can be disabled by setting the environment variable MLFLOW_ENABLE_ARTIFACTS_PROGRESS_BAR to false
"
2025-10-23 09:34:02.022122+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"Loads checkpoint by local backend from path: /tmp/tmptn9hm7rn/checkpoint/model_final.pth
"
2025-10-23 09:34:02.024375+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"Downloading artifacts:   8%|â–Š         | 1/13 [00:00<00:00, 2078.45it/s]Downloading artifacts:  15%|â–ˆâ–Œ        | 2/13 [00:00<00:00, 2567.68it/s]Downloading artifacts:  23%|â–ˆâ–ˆâ–Ž       | 3/13 [00:00<00:00, 2973.28it/s]Downloading artifacts:  31%|â–ˆâ–ˆâ–ˆ       | 4/13 [00:00<00:00, 3260.88it/s]Downloading artifacts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 5/13 [00:00<00:00, 3485.38it/s]Downloading artifacts:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 6/13 [00:00<00:00, 3657.29it/s]Downloading artifacts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 7/13 [00:00<00:00, 3798.21it/s]Downloading artifacts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 8/13 [00:00<00:00, 694.56it/s] Downloading artifacts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 9/13 [00:00<00:00, 353.46it/s]Downloading artifacts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 10/13 [00:00<00:00, 282.07it/s]Downloading artifacts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 260.56it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 144.80it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:16<00:00,  1.23s/it] Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:16<00:00,  1.23s/it]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:16<00:00,  1.23s/it]
"
2025-10-23 09:34:03.174369+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"Making patches:   0%|          | 0/1 [00:00<?, ?it/s]Making patches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 6374.32it/s]
"
2025-10-23 09:34:04.385562+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"2025-10-23 09:34:04.385 | ERROR    | modint.runner.base_runner:inference:137 - An exception occurred:
"
2025-10-23 09:34:04.387762+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"Traceback (most recent call last):
"
2025-10-23 09:34:04.389770+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 09:34:04.391722+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    result = self.predict(data)
"
2025-10-23 09:34:04.393915+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 09:34:04.395985+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    return func(*args, **kwargs)
"
2025-10-23 09:34:04.397909+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 09:34:04.399568+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    return self.model.test_step(batch)
"
2025-10-23 09:34:04.401529+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 09:34:04.403272+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 09:34:04.404834+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 09:34:04.406644+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    results = self(**data, mode=mode)
"
2025-10-23 09:34:04.413210+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 09:34:04.414544+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    return forward_call(*input, **kwargs)
"
2025-10-23 09:34:04.416048+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 09:34:04.417557+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    return self.predict(inputs, data_samples)
"
2025-10-23 09:34:04.418884+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 09:34:04.420489+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 09:34:04.421612+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 09:34:04.423196+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    x = self.backbone(batch_inputs)
"
2025-10-23 09:34:04.425222+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 09:34:04.426763+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    return forward_call(*input, **kwargs)
"
2025-10-23 09:34:04.428120+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 09:34:04.429763+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    x = blk(x)
"
2025-10-23 09:34:04.431299+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 09:34:04.432586+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    return forward_call(*input, **kwargs)
"
2025-10-23 09:34:04.434078+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 09:34:04.435560+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    x = self.attn(x)
"
2025-10-23 09:34:04.436840+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 09:34:04.438336+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    return forward_call(*input, **kwargs)
"
2025-10-23 09:34:04.439969+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 09:34:04.441859+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 09:34:04.443975+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 09:34:04.446573+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 09:34:04.448979+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 09:34:04.451189+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"
"
2025-10-23 09:34:04.453106+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"[32m2025-10-23T09:34:04.385446+0000[0m [31m[1mAn exception occurred:
"
2025-10-23 09:34:04.454841+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"Traceback (most recent call last):
"
2025-10-23 09:34:04.456711+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 09:34:04.458656+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    result = self.predict(data)
"
2025-10-23 09:34:04.460332+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 09:34:04.462064+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    return func(*args, **kwargs)
"
2025-10-23 09:34:04.463712+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 09:34:04.465186+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    return self.model.test_step(batch)
"
2025-10-23 09:34:04.466928+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 09:34:04.468628+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 09:34:04.470119+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 09:34:04.471753+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    results = self(**data, mode=mode)
"
2025-10-23 09:34:04.473235+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 09:34:04.474281+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    return forward_call(*input, **kwargs)
"
2025-10-23 09:34:04.475509+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 09:34:04.477076+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    return self.predict(inputs, data_samples)
"
2025-10-23 09:34:04.478528+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 09:34:04.479810+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 09:34:04.481357+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 09:34:04.482751+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    x = self.backbone(batch_inputs)
"
2025-10-23 09:34:04.483945+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 09:34:04.485363+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    return forward_call(*input, **kwargs)
"
2025-10-23 09:34:04.486756+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 09:34:04.488092+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    x = blk(x)
"
2025-10-23 09:34:04.489452+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 09:34:04.528093+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    return forward_call(*input, **kwargs)
"
2025-10-23 09:34:04.530378+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 09:34:04.532621+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    x = self.attn(x)
"
2025-10-23 09:34:04.534506+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 09:34:04.537244+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    return forward_call(*input, **kwargs)
"
2025-10-23 09:34:04.539239+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 09:34:04.541405+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 09:34:04.543273+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 09:34:04.544967+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 09:34:04.546878+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 09:34:04.548918+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,"[0m
"
2025-10-23 09:34:11.653687+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52df-7023-87c0-c27dc5380703,Finished in state Completed()
2025-10-23 09:34:15.468884+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52e3-75a6-a4e0-770d55c7d6b0,"{'msg': 'Traceback (most recent call last):\n  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference\n    result = self.predict(data)\n  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context\n    return func(*args, **kwargs)\n  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict\n    return self.model.test_step(batch)\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step\n    return self._run_forward(data, mode=\'predict\')  # type: ignore\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward\n    results = self(**data, mode=mode)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward\n    return self.predict(inputs, data_samples)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict\n    x = self.extract_feat(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat\n    x = self.backbone(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward\n    x = blk(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward\n    x = self.attn(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward\n    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos\n    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504\nRuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)\n', 'retriable': False}"
2025-10-23 09:34:15.475900+00:00,40,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52e3-75a6-a4e0-770d55c7d6b0,Inference was failed. See the logs for detail.
2025-10-23 09:34:15.478206+00:00,40,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52e3-75a6-a4e0-770d55c7d6b0,"Task run failed with exception: InferenceFailError() - No retries configured for this task.
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 09:34:15.494032+00:00,40,c63c78cd-ba19-47a2-bbcb-b11a2983983d,019a106a-52e3-75a6-a4e0-770d55c7d6b0,Finished in state Failed('Task run encountered an exception InferenceFailError: ')
2025-10-23 09:34:15.504804+00:00,40,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,"Encountered exception during execution: InferenceFailError()
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 09:34:15.566498+00:00,20,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,Finished in state Failed('Flow run encountered an exception: InferenceFailError: ')
2025-10-23 09:34:15.569526+00:00,40,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,"Engine execution exited with unexpected exception
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1554, in run_flow
    ret_val = run_flow_sync(**kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1399, in run_flow_sync
    return engine.state if return_type == ""state"" else engine.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 361, in result
    raise self._raised
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 09:34:16.495950+00:00,40,c63c78cd-ba19-47a2-bbcb-b11a2983983d,,Process for flow run 'phi6-gruis-p' exited with status code: 1
