timestamp,level,flow_run_id,task_run_id,message
2025-10-22 07:31:49.004457+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Worker 'KubernetesWorker a05e490e-9eac-4523-9166-1b04920e6d58' submitting flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-22 07:31:51.442531+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Creating Kubernetes job...
2025-10-22 07:31:51.612822+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Completed submission of flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-22 07:31:58.136896+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Opening process...
2025-10-22 07:32:01.064512+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,, > Running git_clone step...
2025-10-22 07:32:07.152902+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Beginning flow run 'hilarious-gazelle' for flow 'run-modint-flow'
2025-10-22 07:32:07.335391+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1194-7347-8b39-7c9ef181fff3,This job ID will be used - modint-prefect-hilarious-gazelle-1
2025-10-22 07:32:07.341297+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1194-7347-8b39-7c9ef181fff3,Finished in state Completed()
2025-10-22 07:32:07.880510+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1230-762f-96c8-47663e6e8ac2,Finished in state Completed()
2025-10-22 07:32:07.935674+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1233-7a98-a00f-582069bf7ebb,{'scene_path': '/nas/Dataset/securewatch/geofocus/20240110_50cm_Hamju/050195143010_01/050195143010_01_P001_PSH/23NOV22020447-S2AS-050195143010_01_P001.TIF'}
2025-10-22 07:32:08.010941+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-14ab-74ba-83b9-4d53c8c6c8c8,Finished in state Completed()
2025-10-22 07:32:09.807208+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,Beginning subflow run 'steadfast-toucan' for flow 'run-namespaced-job'
2025-10-22 07:32:17.951003+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"Downloading artifacts:   0%|          | 0/13 [00:00<?, ?it/s]2025/10/22 07:32:17 INFO mlflow.store.artifact.artifact_repo: The progress bar can be disabled by setting the environment variable MLFLOW_ENABLE_ARTIFACTS_PROGRESS_BAR to false
"
2025-10-22 07:32:54.705693+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"Downloading artifacts:   8%|â–Š         | 1/13 [00:00<00:00, 111.92it/s]Downloading artifacts:  15%|â–ˆâ–Œ        | 2/13 [00:00<00:00, 169.14it/s]Downloading artifacts:  23%|â–ˆâ–ˆâ–Ž       | 3/13 [00:00<00:00, 222.70it/s]Downloading artifacts:  31%|â–ˆâ–ˆâ–ˆ       | 4/13 [00:00<00:00, 179.28it/s]Downloading artifacts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 5/13 [00:00<00:00, 165.61it/s]Downloading artifacts:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 6/13 [00:00<00:00, 186.00it/s]Downloading artifacts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 7/13 [00:00<00:00, 150.51it/s]Downloading artifacts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 8/13 [00:00<00:00, 166.56it/s]Downloading artifacts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 9/13 [00:00<00:00, 181.96it/s]Downloading artifacts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 10/13 [00:00<00:00, 182.92it/s]Downloading artifacts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 188.05it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 80.11it/s] Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 80.11it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00, 80.11it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00,  1.11s/it]
"
2025-10-22 07:32:54.709450+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"Loads checkpoint by local backend from path: /tmp/tmpejewe59h/checkpoint/model_final.pth
"
2025-10-22 07:32:56.127139+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"Making patches:   0%|          | 0/1 [00:00<?, ?it/s]Making patches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 13025.79it/s]
"
2025-10-22 07:33:00.660441+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"2025-10-22 07:33:00.662 | ERROR    | modint.runner.base_runner:inference:137 - An exception occurred:
"
2025-10-22 07:33:00.663049+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"Traceback (most recent call last):
"
2025-10-22 07:33:00.665177+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-22 07:33:00.667494+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    result = self.predict(data)
"
2025-10-22 07:33:00.669758+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-22 07:33:00.671402+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    return func(*args, **kwargs)
"
2025-10-22 07:33:00.673156+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-22 07:33:00.674642+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    return self.model.test_step(batch)
"
2025-10-22 07:33:00.676540+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-22 07:33:00.678437+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-22 07:33:00.680365+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-22 07:33:00.681794+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    results = self(**data, mode=mode)
"
2025-10-22 07:33:00.683032+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-22 07:33:00.687017+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    return forward_call(*input, **kwargs)
"
2025-10-22 07:33:00.688572+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-22 07:33:00.689851+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    return self.predict(inputs, data_samples)
"
2025-10-22 07:33:00.691264+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-22 07:33:00.695335+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    x = self.extract_feat(batch_inputs)
"
2025-10-22 07:33:00.696407+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-22 07:33:00.697282+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    x = self.backbone(batch_inputs)
"
2025-10-22 07:33:00.698549+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-22 07:33:00.699560+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    return forward_call(*input, **kwargs)
"
2025-10-22 07:33:00.700563+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-22 07:33:00.701802+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    x = blk(x)
"
2025-10-22 07:33:00.702861+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-22 07:33:00.703950+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    return forward_call(*input, **kwargs)
"
2025-10-22 07:33:00.708544+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-22 07:33:00.709647+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    x = self.attn(x)
"
2025-10-22 07:33:00.710635+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-22 07:33:00.711936+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    return forward_call(*input, **kwargs)
"
2025-10-22 07:33:00.713136+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-22 07:33:00.714610+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-22 07:33:00.715954+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-22 07:33:00.717266+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-22 07:33:00.718520+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-22 07:33:00.719685+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"
"
2025-10-22 07:33:00.720602+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"[32m2025-10-22T07:33:00.662712+0000[0m [31m[1mAn exception occurred:
"
2025-10-22 07:33:00.721431+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"Traceback (most recent call last):
"
2025-10-22 07:33:00.722200+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-22 07:33:00.722972+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    result = self.predict(data)
"
2025-10-22 07:33:00.723726+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-22 07:33:00.724742+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    return func(*args, **kwargs)
"
2025-10-22 07:33:00.725522+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-22 07:33:00.726302+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    return self.model.test_step(batch)
"
2025-10-22 07:33:00.727078+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-22 07:33:00.728401+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-22 07:33:00.729647+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-22 07:33:00.730733+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    results = self(**data, mode=mode)
"
2025-10-22 07:33:00.731817+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-22 07:33:00.732870+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    return forward_call(*input, **kwargs)
"
2025-10-22 07:33:00.733667+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-22 07:33:00.734305+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    return self.predict(inputs, data_samples)
"
2025-10-22 07:33:00.735272+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-22 07:33:00.736374+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    x = self.extract_feat(batch_inputs)
"
2025-10-22 07:33:00.737424+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-22 07:33:00.738427+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    x = self.backbone(batch_inputs)
"
2025-10-22 07:33:00.739441+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-22 07:33:00.740455+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    return forward_call(*input, **kwargs)
"
2025-10-22 07:33:00.741513+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-22 07:33:00.742488+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    x = blk(x)
"
2025-10-22 07:33:00.743519+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-22 07:33:00.744552+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    return forward_call(*input, **kwargs)
"
2025-10-22 07:33:00.745339+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-22 07:33:00.746350+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    x = self.attn(x)
"
2025-10-22 07:33:00.747441+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-22 07:33:00.748524+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    return forward_call(*input, **kwargs)
"
2025-10-22 07:33:00.749159+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-22 07:33:00.749762+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-22 07:33:00.750709+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-22 07:33:00.751338+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-22 07:33:00.752004+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-22 07:33:00.752878+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,"[0m
"
2025-10-22 07:33:07.977957+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1231-70c2-a17e-a0d49f7b1d03,Finished in state Completed()
2025-10-22 07:33:08.002425+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1233-7a98-a00f-582069bf7ebb,"{'msg': 'Traceback (most recent call last):\n  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference\n    result = self.predict(data)\n  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context\n    return func(*args, **kwargs)\n  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict\n    return self.model.test_step(batch)\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step\n    return self._run_forward(data, mode=\'predict\')  # type: ignore\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward\n    results = self(**data, mode=mode)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward\n    return self.predict(inputs, data_samples)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict\n    x = self.extract_feat(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat\n    x = self.backbone(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward\n    x = blk(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward\n    x = self.attn(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward\n    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos\n    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504\nRuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)\n', 'retriable': False}"
2025-10-22 07:33:08.008209+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1233-7a98-a00f-582069bf7ebb,Inference was failed. See the logs for detail.
2025-10-22 07:33:08.010237+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1233-7a98-a00f-582069bf7ebb,"Task run failed with exception: InferenceFailError() - No retries configured for this task.
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-22 07:33:08.026027+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ad5-1233-7a98-a00f-582069bf7ebb,Finished in state Failed('Task run encountered an exception InferenceFailError: ')
2025-10-22 07:33:08.036839+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Encountered exception during execution: InferenceFailError()
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-22 07:33:08.156359+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Finished in state Failed('Flow run encountered an exception: InferenceFailError: ')
2025-10-22 07:33:08.158671+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Engine execution exited with unexpected exception
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1554, in run_flow
    ret_val = run_flow_sync(**kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1399, in run_flow_sync
    return engine.state if return_type == ""state"" else engine.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 361, in result
    raise self._raised
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-22 07:33:08.789699+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Process for flow run 'hilarious-gazelle' exited with status code: 1
2025-10-23 01:43:06.886721+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Worker 'KubernetesWorker a05e490e-9eac-4523-9166-1b04920e6d58' submitting flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 01:43:07.044731+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Creating Kubernetes job...
2025-10-23 01:43:07.247884+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Completed submission of flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 01:43:13.788720+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Opening process...
2025-10-23 01:43:16.719983+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,, > Running git_clone step...
2025-10-23 01:43:22.382396+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Beginning flow run 'hilarious-gazelle' for flow 'run-modint-flow'
2025-10-23 01:43:22.523552+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-242f-7873-82a2-1ea430e17b96,This job ID will be used - modint-prefect-hilarious-gazelle-2
2025-10-23 01:43:22.529600+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-242f-7873-82a2-1ea430e17b96,Finished in state Completed()
2025-10-23 01:43:23.027075+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a4-7de0-91a1-e2da94578196,Finished in state Completed()
2025-10-23 01:43:23.068796+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a8-77b2-9fe4-aa15c65a0cee,{'scene_path': '/nas/Dataset/securewatch/geofocus/20240110_50cm_Hamju/050195143010_01/050195143010_01_P001_PSH/23NOV22020447-S2AS-050195143010_01_P001.TIF'}
2025-10-23 01:43:23.187609+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-2715-7db5-bafc-f7262958f27f,Finished in state Completed()
2025-10-23 01:43:23.994608+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,Beginning subflow run 'steadfast-toucan' for flow 'run-namespaced-job'
2025-10-23 01:43:32.119071+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"Downloading artifacts:   0%|          | 0/13 [00:00<?, ?it/s]2025/10/23 01:43:32 INFO mlflow.store.artifact.artifact_repo: The progress bar can be disabled by setting the environment variable MLFLOW_ENABLE_ARTIFACTS_PROGRESS_BAR to false
"
2025-10-23 01:44:09.128599+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"Downloading artifacts:   8%|â–Š         | 1/13 [00:00<00:00, 1612.57it/s]Downloading artifacts:  15%|â–ˆâ–Œ        | 2/13 [00:00<00:00, 1251.47it/s]Downloading artifacts:  23%|â–ˆâ–ˆâ–Ž       | 3/13 [00:00<00:00, 159.36it/s] Downloading artifacts:  31%|â–ˆâ–ˆâ–ˆ       | 4/13 [00:00<00:00, 168.68it/s]Downloading artifacts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 5/13 [00:00<00:00, 204.03it/s]Downloading artifacts:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 6/13 [00:00<00:00, 238.89it/s]Downloading artifacts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 7/13 [00:00<00:00, 269.17it/s]Downloading artifacts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 8/13 [00:00<00:00, 270.22it/s]Downloading artifacts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 9/13 [00:00<00:00, 293.29it/s]Downloading artifacts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 10/13 [00:00<00:00, 291.47it/s]Downloading artifacts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 283.21it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 146.61it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00,  1.10s/it] Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00,  1.10s/it]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00,  1.10s/it]
"
2025-10-23 01:44:09.132815+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"Loads checkpoint by local backend from path: /tmp/tmp5xz_u46j/checkpoint/model_final.pth
"
2025-10-23 01:44:10.366546+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"Making patches:   0%|          | 0/1 [00:00<?, ?it/s]Making patches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 14463.12it/s]
"
2025-10-23 01:44:13.080410+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"2025-10-23 01:44:13.089 | ERROR    | modint.runner.base_runner:inference:137 - An exception occurred:
"
2025-10-23 01:44:13.082877+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"Traceback (most recent call last):
"
2025-10-23 01:44:13.084991+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 01:44:13.086902+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    result = self.predict(data)
"
2025-10-23 01:44:13.089297+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 01:44:13.091488+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    return func(*args, **kwargs)
"
2025-10-23 01:44:13.093070+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 01:44:13.094517+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    return self.model.test_step(batch)
"
2025-10-23 01:44:13.095962+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 01:44:13.097428+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 01:44:13.098868+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 01:44:13.099977+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    results = self(**data, mode=mode)
"
2025-10-23 01:44:13.105567+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:44:13.107489+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:44:13.108752+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 01:44:13.109859+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    return self.predict(inputs, data_samples)
"
2025-10-23 01:44:13.110939+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 01:44:13.112049+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 01:44:13.113119+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 01:44:13.114213+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    x = self.backbone(batch_inputs)
"
2025-10-23 01:44:13.115278+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:44:13.116599+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:44:13.117924+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 01:44:13.119752+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    x = blk(x)
"
2025-10-23 01:44:13.121103+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:44:13.121954+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:44:13.123118+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 01:44:13.123962+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    x = self.attn(x)
"
2025-10-23 01:44:13.124752+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:44:13.125539+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:44:13.126306+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 01:44:13.127076+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 01:44:13.127849+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 01:44:13.128651+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 01:44:13.129300+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 01:44:13.130853+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"
"
2025-10-23 01:44:13.132371+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"[32m2025-10-23T01:44:13.089841+0000[0m [31m[1mAn exception occurred:
"
2025-10-23 01:44:13.133585+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"Traceback (most recent call last):
"
2025-10-23 01:44:13.134332+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 01:44:13.135157+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    result = self.predict(data)
"
2025-10-23 01:44:13.136441+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 01:44:13.137895+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    return func(*args, **kwargs)
"
2025-10-23 01:44:13.138682+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 01:44:13.139604+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    return self.model.test_step(batch)
"
2025-10-23 01:44:13.140863+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 01:44:13.142198+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 01:44:13.142866+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 01:44:13.143612+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    results = self(**data, mode=mode)
"
2025-10-23 01:44:13.144421+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:44:13.145656+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:44:13.146982+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 01:44:13.148005+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    return self.predict(inputs, data_samples)
"
2025-10-23 01:44:13.149243+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 01:44:13.151010+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 01:44:13.151803+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 01:44:13.152436+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    x = self.backbone(batch_inputs)
"
2025-10-23 01:44:13.153231+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:44:13.154625+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:44:13.155866+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 01:44:13.157017+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    x = blk(x)
"
2025-10-23 01:44:13.157650+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:44:13.158375+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:44:13.159143+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 01:44:13.160416+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    x = self.attn(x)
"
2025-10-23 01:44:13.161876+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:44:13.162675+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:44:13.163300+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 01:44:13.163934+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 01:44:13.164703+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 01:44:13.165378+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 01:44:13.166145+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 01:44:13.167353+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,"[0m
"
2025-10-23 01:44:23.142845+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a8-77b2-9fe4-aa15c65a0cee,"{'msg': 'Traceback (most recent call last):\n  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference\n    result = self.predict(data)\n  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context\n    return func(*args, **kwargs)\n  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict\n    return self.model.test_step(batch)\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step\n    return self._run_forward(data, mode=\'predict\')  # type: ignore\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward\n    results = self(**data, mode=mode)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward\n    return self.predict(inputs, data_samples)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict\n    x = self.extract_feat(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat\n    x = self.backbone(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward\n    x = blk(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward\n    x = self.attn(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward\n    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos\n    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504\nRuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)\n', 'retriable': False}"
2025-10-23 01:44:23.149527+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a8-77b2-9fe4-aa15c65a0cee,Inference was failed. See the logs for detail.
2025-10-23 01:44:23.151561+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a8-77b2-9fe4-aa15c65a0cee,"Task run failed with exception: InferenceFailError() - No retries configured for this task.
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 01:44:23.168013+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a8-77b2-9fe4-aa15c65a0cee,Finished in state Failed('Task run encountered an exception InferenceFailError: ')
2025-10-23 01:44:28.366150+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebc-24a5-768d-ae8b-98de3080c50d,Finished in state Completed()
2025-10-23 01:44:28.376727+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Encountered exception during execution: InferenceFailError()
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 01:44:28.440856+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Finished in state Failed('Flow run encountered an exception: InferenceFailError: ')
2025-10-23 01:44:28.443632+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Engine execution exited with unexpected exception
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1554, in run_flow
    ret_val = run_flow_sync(**kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1399, in run_flow_sync
    return engine.state if return_type == ""state"" else engine.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 361, in result
    raise self._raised
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 01:44:29.148749+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Process for flow run 'hilarious-gazelle' exited with status code: 1
2025-10-23 01:46:05.164375+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Worker 'KubernetesWorker a05e490e-9eac-4523-9166-1b04920e6d58' submitting flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 01:46:05.340849+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Creating Kubernetes job...
2025-10-23 01:46:05.554509+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Completed submission of flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 01:46:11.660712+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Opening process...
2025-10-23 01:46:14.398717+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,, > Running git_clone step...
2025-10-23 01:46:20.521004+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Beginning flow run 'hilarious-gazelle' for flow 'run-modint-flow'
2025-10-23 01:46:20.732419+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dc0c-738c-a9a7-ddb56bf760d0,This job ID will be used - modint-prefect-hilarious-gazelle-3
2025-10-23 01:46:20.738581+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dc0c-738c-a9a7-ddb56bf760d0,Finished in state Completed()
2025-10-23 01:46:21.254176+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-7cda-aa7b-9f250ca0f343,Finished in state Completed()
2025-10-23 01:46:21.403715+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc8-7cc1-a259-c30e4eaf3369,{'scene_path': '/nas/Dataset/securewatch/geofocus/20240110_50cm_Hamju/050195143010_01/050195143010_01_P001_PSH/23NOV22020447-S2AS-050195143010_01_P001.TIF'}
2025-10-23 01:46:21.409763+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-df38-71a8-8df0-62fa619d5c34,Finished in state Completed()
2025-10-23 01:46:22.230075+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,Beginning subflow run 'steadfast-toucan' for flow 'run-namespaced-job'
2025-10-23 01:46:30.000446+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"Downloading artifacts:   0%|          | 0/13 [00:00<?, ?it/s]2025/10/23 01:46:30 INFO mlflow.store.artifact.artifact_repo: The progress bar can be disabled by setting the environment variable MLFLOW_ENABLE_ARTIFACTS_PROGRESS_BAR to false
"
2025-10-23 01:47:12.543503+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"Downloading artifacts:   8%|â–Š         | 1/13 [00:00<00:00, 2863.01it/s]Downloading artifacts:  15%|â–ˆâ–Œ        | 2/13 [00:00<00:00, 3903.49it/s]Downloading artifacts:  23%|â–ˆâ–ˆâ–Ž       | 3/13 [00:00<00:00, 4712.70it/s]Downloading artifacts:  31%|â–ˆâ–ˆâ–ˆ       | 4/13 [00:00<00:00, 5321.03it/s]Downloading artifacts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 5/13 [00:00<00:00, 5658.80it/s]Downloading artifacts:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 6/13 [00:00<00:00, 6021.97it/s]Downloading artifacts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 7/13 [00:00<00:00, 366.36it/s] Downloading artifacts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 8/13 [00:00<00:00, 272.45it/s]Downloading artifacts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 9/13 [00:00<00:00, 205.51it/s]Downloading artifacts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 10/13 [00:00<00:00, 202.12it/s]Downloading artifacts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 125.27it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 132.81it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00,  1.08s/it] Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00,  1.08s/it]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00,  1.08s/it]
"
2025-10-23 01:47:12.547080+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"Loads checkpoint by local backend from path: /tmp/tmpuq1su8_u/checkpoint/model_final.pth
"
2025-10-23 01:47:13.834198+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"Making patches:   0%|          | 0/1 [00:00<?, ?it/s]Making patches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 10672.53it/s]
"
2025-10-23 01:47:15.519730+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"2025-10-23 01:47:15.530 | ERROR    | modint.runner.base_runner:inference:137 - An exception occurred:
"
2025-10-23 01:47:15.522802+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"Traceback (most recent call last):
"
2025-10-23 01:47:15.524874+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 01:47:15.527590+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    result = self.predict(data)
"
2025-10-23 01:47:15.529540+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 01:47:15.531709+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    return func(*args, **kwargs)
"
2025-10-23 01:47:15.533792+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 01:47:15.535482+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    return self.model.test_step(batch)
"
2025-10-23 01:47:15.537352+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 01:47:15.539232+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 01:47:15.540972+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 01:47:15.542887+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    results = self(**data, mode=mode)
"
2025-10-23 01:47:15.544574+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:47:15.546007+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:47:15.552716+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 01:47:15.554857+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    return self.predict(inputs, data_samples)
"
2025-10-23 01:47:15.558556+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 01:47:15.560908+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 01:47:15.562925+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 01:47:15.564294+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    x = self.backbone(batch_inputs)
"
2025-10-23 01:47:15.565949+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:47:15.567397+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:47:15.569075+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 01:47:15.570674+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    x = blk(x)
"
2025-10-23 01:47:15.572098+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:47:15.573787+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:47:15.575162+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 01:47:15.576412+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    x = self.attn(x)
"
2025-10-23 01:47:15.577855+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:47:15.579248+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:47:15.580431+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 01:47:15.581886+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 01:47:15.583249+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 01:47:15.623342+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 01:47:15.625601+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 01:47:15.627722+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"
"
2025-10-23 01:47:15.629586+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"[32m2025-10-23T01:47:15.530447+0000[0m [31m[1mAn exception occurred:
"
2025-10-23 01:47:15.631754+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"Traceback (most recent call last):
"
2025-10-23 01:47:15.633864+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 01:47:15.635684+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    result = self.predict(data)
"
2025-10-23 01:47:15.637576+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 01:47:15.639548+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    return func(*args, **kwargs)
"
2025-10-23 01:47:15.641228+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 01:47:15.643136+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    return self.model.test_step(batch)
"
2025-10-23 01:47:15.644842+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 01:47:15.646210+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 01:47:15.647860+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 01:47:15.649437+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    results = self(**data, mode=mode)
"
2025-10-23 01:47:15.650837+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:47:15.652471+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:47:15.654031+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 01:47:15.655294+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    return self.predict(inputs, data_samples)
"
2025-10-23 01:47:15.656728+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 01:47:15.658132+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 01:47:15.659280+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 01:47:15.660737+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    x = self.backbone(batch_inputs)
"
2025-10-23 01:47:15.662092+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:47:15.663259+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:47:15.665139+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 01:47:15.666188+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    x = blk(x)
"
2025-10-23 01:47:15.667503+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:47:15.668673+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:47:15.669690+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 01:47:15.670973+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    x = self.attn(x)
"
2025-10-23 01:47:15.673342+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:47:15.674293+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:47:15.675938+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 01:47:15.676935+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 01:47:15.678111+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 01:47:15.722660+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 01:47:15.724535+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 01:47:15.726763+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,"[0m
"
2025-10-23 01:47:21.474820+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc8-7cc1-a259-c30e4eaf3369,"{'msg': 'Traceback (most recent call last):\n  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference\n    result = self.predict(data)\n  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context\n    return func(*args, **kwargs)\n  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict\n    return self.model.test_step(batch)\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step\n    return self._run_forward(data, mode=\'predict\')  # type: ignore\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward\n    results = self(**data, mode=mode)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward\n    return self.predict(inputs, data_samples)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict\n    x = self.extract_feat(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat\n    x = self.backbone(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward\n    x = blk(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward\n    x = self.attn(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward\n    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos\n    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504\nRuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)\n', 'retriable': False}"
2025-10-23 01:47:21.480940+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc8-7cc1-a259-c30e4eaf3369,Inference was failed. See the logs for detail.
2025-10-23 01:47:21.483158+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc8-7cc1-a259-c30e4eaf3369,"Task run failed with exception: InferenceFailError() - No retries configured for this task.
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 01:47:21.498950+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc8-7cc1-a259-c30e4eaf3369,Finished in state Failed('Task run encountered an exception InferenceFailError: ')
2025-10-23 01:47:23.909056+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ebe-dcc6-714b-a9d6-93290b6593b5,Finished in state Completed()
2025-10-23 01:47:23.918143+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Encountered exception during execution: InferenceFailError()
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 01:47:23.976505+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Finished in state Failed('Flow run encountered an exception: InferenceFailError: ')
2025-10-23 01:47:23.979073+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Engine execution exited with unexpected exception
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1554, in run_flow
    ret_val = run_flow_sync(**kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1399, in run_flow_sync
    return engine.state if return_type == ""state"" else engine.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 361, in result
    raise self._raised
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 01:47:24.598006+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Process for flow run 'hilarious-gazelle' exited with status code: 1
2025-10-23 01:48:48.277283+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Worker 'KubernetesWorker a05e490e-9eac-4523-9166-1b04920e6d58' submitting flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 01:48:48.437073+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Creating Kubernetes job...
2025-10-23 01:48:48.746750+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Completed submission of flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 01:48:54.967137+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Opening process...
2025-10-23 01:48:58.207037+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,, > Running git_clone step...
2025-10-23 01:49:03.940103+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Beginning flow run 'hilarious-gazelle' for flow 'run-modint-flow'
2025-10-23 01:49:04.139187+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5a66-7cb1-8bb7-ec4851a8bcf5,This job ID will be used - modint-prefect-hilarious-gazelle-4
2025-10-23 01:49:04.145083+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5a66-7cb1-8bb7-ec4851a8bcf5,Finished in state Completed()
2025-10-23 01:49:04.576438+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-735d-a816-ee0c1af9d083,Finished in state Completed()
2025-10-23 01:49:04.625289+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b16-7ad0-99f6-ff9f730a9039,{'scene_path': '/nas/Dataset/securewatch/geofocus/20240110_50cm_Hamju/050195143010_01/050195143010_01_P001_PSH/23NOV22020447-S2AS-050195143010_01_P001.TIF'}
2025-10-23 01:49:04.692425+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5d1d-7f55-9702-989fa7752ec1,Finished in state Completed()
2025-10-23 01:49:05.861486+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,Beginning subflow run 'steadfast-toucan' for flow 'run-namespaced-job'
2025-10-23 01:49:12.992258+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"Downloading artifacts:   0%|          | 0/13 [00:00<?, ?it/s]2025/10/23 01:49:13 INFO mlflow.store.artifact.artifact_repo: The progress bar can be disabled by setting the environment variable MLFLOW_ENABLE_ARTIFACTS_PROGRESS_BAR to false
"
2025-10-23 01:49:45.768126+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"Loads checkpoint by local backend from path: /tmp/tmpi5sn7t8k/checkpoint/model_final.pth
"
2025-10-23 01:49:45.770307+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"Downloading artifacts:   8%|â–Š         | 1/13 [00:00<00:00, 927.74it/s]Downloading artifacts:  15%|â–ˆâ–Œ        | 2/13 [00:00<00:00, 1406.78it/s]Downloading artifacts:  23%|â–ˆâ–ˆâ–Ž       | 3/13 [00:00<00:00, 1811.01it/s]Downloading artifacts:  31%|â–ˆâ–ˆâ–ˆ       | 4/13 [00:00<00:00, 2141.86it/s]Downloading artifacts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 5/13 [00:00<00:00, 2421.65it/s]Downloading artifacts:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 6/13 [00:00<00:00, 2659.67it/s]Downloading artifacts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 7/13 [00:00<00:00, 2861.89it/s]Downloading artifacts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 8/13 [00:00<00:00, 3036.60it/s]Downloading artifacts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 9/13 [00:00<00:00, 3111.25it/s]Downloading artifacts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 10/13 [00:00<00:00, 270.05it/s]Downloading artifacts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 262.14it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 213.83it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:15<00:00,  1.17s/it] Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:15<00:00,  1.17s/it]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:15<00:00,  1.17s/it]
"
2025-10-23 01:49:46.831424+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"Making patches:   0%|          | 0/1 [00:00<?, ?it/s]Making patches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 13400.33it/s]
"
2025-10-23 01:49:48.439252+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"2025-10-23 01:49:48.450 | ERROR    | modint.runner.base_runner:inference:137 - An exception occurred:
"
2025-10-23 01:49:48.441354+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"Traceback (most recent call last):
"
2025-10-23 01:49:48.443863+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 01:49:48.446070+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    result = self.predict(data)
"
2025-10-23 01:49:48.448420+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 01:49:48.450229+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    return func(*args, **kwargs)
"
2025-10-23 01:49:48.452047+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 01:49:48.453918+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    return self.model.test_step(batch)
"
2025-10-23 01:49:48.455744+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 01:49:48.457452+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 01:49:48.464282+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 01:49:48.465497+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    results = self(**data, mode=mode)
"
2025-10-23 01:49:48.466885+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:49:48.468429+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:49:48.469702+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 01:49:48.471751+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    return self.predict(inputs, data_samples)
"
2025-10-23 01:49:48.473241+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 01:49:48.475297+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 01:49:48.476736+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 01:49:48.478788+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    x = self.backbone(batch_inputs)
"
2025-10-23 01:49:48.480383+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:49:48.481987+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:49:48.483247+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 01:49:48.484405+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    x = blk(x)
"
2025-10-23 01:49:48.485750+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:49:48.487273+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:49:48.488555+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 01:49:48.489963+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    x = self.attn(x)
"
2025-10-23 01:49:48.491287+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:49:48.492526+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:49:48.493896+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 01:49:48.494961+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 01:49:48.496144+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 01:49:48.497483+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 01:49:48.498548+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 01:49:48.499745+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"
"
2025-10-23 01:49:48.500958+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"[32m2025-10-23T01:49:48.450922+0000[0m [31m[1mAn exception occurred:
"
2025-10-23 01:49:48.522794+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"Traceback (most recent call last):
"
2025-10-23 01:49:48.525037+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 01:49:48.527150+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    result = self.predict(data)
"
2025-10-23 01:49:48.528942+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 01:49:48.531267+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    return func(*args, **kwargs)
"
2025-10-23 01:49:48.533355+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 01:49:48.535285+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    return self.model.test_step(batch)
"
2025-10-23 01:49:48.537444+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 01:49:48.539777+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 01:49:48.542202+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 01:49:48.543888+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    results = self(**data, mode=mode)
"
2025-10-23 01:49:48.546178+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:49:48.547791+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:49:48.550097+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 01:49:48.551561+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    return self.predict(inputs, data_samples)
"
2025-10-23 01:49:48.553607+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 01:49:48.555031+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 01:49:48.556645+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 01:49:48.558309+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    x = self.backbone(batch_inputs)
"
2025-10-23 01:49:48.559725+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:49:48.561178+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:49:48.562629+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 01:49:48.563847+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    x = blk(x)
"
2025-10-23 01:49:48.565174+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:49:48.566633+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:49:48.567825+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 01:49:48.569179+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    x = self.attn(x)
"
2025-10-23 01:49:48.570612+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:49:48.571638+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:49:48.572768+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 01:49:48.574057+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 01:49:48.575100+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 01:49:48.576251+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 01:49:48.577544+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 01:49:48.578750+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,"[0m
"
2025-10-23 01:49:57.058032+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b14-7622-998f-d756dffeb5df,Finished in state Completed()
2025-10-23 01:50:04.666752+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b16-7ad0-99f6-ff9f730a9039,"{'msg': 'Traceback (most recent call last):\n  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference\n    result = self.predict(data)\n  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context\n    return func(*args, **kwargs)\n  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict\n    return self.model.test_step(batch)\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step\n    return self._run_forward(data, mode=\'predict\')  # type: ignore\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward\n    results = self(**data, mode=mode)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward\n    return self.predict(inputs, data_samples)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict\n    x = self.extract_feat(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat\n    x = self.backbone(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward\n    x = blk(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward\n    x = self.attn(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward\n    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos\n    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504\nRuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)\n', 'retriable': False}"
2025-10-23 01:50:04.672874+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b16-7ad0-99f6-ff9f730a9039,Inference was failed. See the logs for detail.
2025-10-23 01:50:04.675071+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b16-7ad0-99f6-ff9f730a9039,"Task run failed with exception: InferenceFailError() - No retries configured for this task.
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 01:50:04.689712+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec1-5b16-7ad0-99f6-ff9f730a9039,Finished in state Failed('Task run encountered an exception InferenceFailError: ')
2025-10-23 01:50:04.699566+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Encountered exception during execution: InferenceFailError()
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 01:50:04.770271+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Finished in state Failed('Flow run encountered an exception: InferenceFailError: ')
2025-10-23 01:50:04.773015+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Engine execution exited with unexpected exception
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1554, in run_flow
    ret_val = run_flow_sync(**kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1399, in run_flow_sync
    return engine.state if return_type == ""state"" else engine.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 361, in result
    raise self._raised
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 01:50:05.356529+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Process for flow run 'hilarious-gazelle' exited with status code: 1
2025-10-23 01:51:32.280837+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Worker 'KubernetesWorker a05e490e-9eac-4523-9166-1b04920e6d58' submitting flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 01:51:32.445701+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Creating Kubernetes job...
2025-10-23 01:51:32.648728+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Completed submission of flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 01:51:39.066578+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Opening process...
2025-10-23 01:51:41.698450+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,, > Running git_clone step...
2025-10-23 01:51:47.179034+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Beginning flow run 'hilarious-gazelle' for flow 'run-modint-flow'
2025-10-23 01:51:47.328157+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d80e-712d-91cc-214181494e58,This job ID will be used - modint-prefect-hilarious-gazelle-5
2025-10-23 01:51:47.333969+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d80e-712d-91cc-214181494e58,Finished in state Completed()
2025-10-23 01:51:47.829852+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-7cc2-ab61-f1e62bab4195,Finished in state Completed()
2025-10-23 01:51:47.873123+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d88d-73ed-9f86-753fa0da454d,{'scene_path': '/nas/Dataset/securewatch/geofocus/20240110_50cm_Hamju/050195143010_01/050195143010_01_P001_PSH/23NOV22020447-S2AS-050195143010_01_P001.TIF'}
2025-10-23 01:51:47.987034+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-daf5-7cae-b394-a086cf5c1622,Finished in state Completed()
2025-10-23 01:51:48.755258+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,Beginning subflow run 'steadfast-toucan' for flow 'run-namespaced-job'
2025-10-23 01:51:56.960407+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"Downloading artifacts:   0%|          | 0/13 [00:00<?, ?it/s]2025/10/23 01:51:56 INFO mlflow.store.artifact.artifact_repo: The progress bar can be disabled by setting the environment variable MLFLOW_ENABLE_ARTIFACTS_PROGRESS_BAR to false
"
2025-10-23 01:52:30.467652+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"Downloading artifacts:   8%|â–Š         | 1/13 [00:00<00:00, 1572.67it/s]Downloading artifacts:  15%|â–ˆâ–Œ        | 2/13 [00:00<00:00, 2174.34it/s]Downloading artifacts:  23%|â–ˆâ–ˆâ–Ž       | 3/13 [00:00<00:00, 2604.08it/s]Downloading artifacts:  31%|â–ˆâ–ˆâ–ˆ       | 4/13 [00:00<00:00, 2931.03it/s]Downloading artifacts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 5/13 [00:00<00:00, 405.53it/s] Downloading artifacts:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 6/13 [00:00<00:00, 473.28it/s]Downloading artifacts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 7/13 [00:00<00:00, 428.32it/s]Downloading artifacts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 8/13 [00:00<00:00, 190.97it/s]Downloading artifacts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 9/13 [00:00<00:00, 180.76it/s]Downloading artifacts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 10/13 [00:00<00:00, 185.73it/s]Downloading artifacts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 104.62it/s]Downloading artifacts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 104.62it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 104.62it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00, 104.62it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00,  1.09s/it] 
"
2025-10-23 01:52:30.471588+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"Loads checkpoint by local backend from path: /tmp/tmpt9389axs/checkpoint/model_final.pth
"
2025-10-23 01:52:32.033508+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"Making patches:   0%|          | 0/1 [00:00<?, ?it/s]Making patches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 11781.75it/s]
"
2025-10-23 01:52:33.601958+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"2025-10-23 01:52:33.609 | ERROR    | modint.runner.base_runner:inference:137 - An exception occurred:
"
2025-10-23 01:52:33.604417+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"Traceback (most recent call last):
"
2025-10-23 01:52:33.606950+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 01:52:33.609524+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    result = self.predict(data)
"
2025-10-23 01:52:33.612250+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 01:52:33.614760+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    return func(*args, **kwargs)
"
2025-10-23 01:52:33.620694+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 01:52:33.622400+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    return self.model.test_step(batch)
"
2025-10-23 01:52:33.624341+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 01:52:33.626687+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 01:52:33.628946+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 01:52:33.631060+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    results = self(**data, mode=mode)
"
2025-10-23 01:52:33.633373+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:52:33.635622+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:52:33.637330+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 01:52:33.638942+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    return self.predict(inputs, data_samples)
"
2025-10-23 01:52:33.640414+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 01:52:33.642142+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 01:52:33.643722+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 01:52:33.645179+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    x = self.backbone(batch_inputs)
"
2025-10-23 01:52:33.647131+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:52:33.648501+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:52:33.649655+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 01:52:33.650787+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    x = blk(x)
"
2025-10-23 01:52:33.651894+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:52:33.653338+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:52:33.654867+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 01:52:33.656168+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    x = self.attn(x)
"
2025-10-23 01:52:33.657106+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:52:33.658831+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:52:33.660029+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 01:52:33.661243+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 01:52:33.662246+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 01:52:33.663570+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 01:52:33.664796+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 01:52:33.665715+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"
"
2025-10-23 01:52:33.666908+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"[32m2025-10-23T01:52:33.609285+0000[0m [31m[1mAn exception occurred:
"
2025-10-23 01:52:33.667960+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"Traceback (most recent call last):
"
2025-10-23 01:52:33.669113+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 01:52:33.669832+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    result = self.predict(data)
"
2025-10-23 01:52:33.670658+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 01:52:33.671832+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    return func(*args, **kwargs)
"
2025-10-23 01:52:33.672969+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 01:52:33.674037+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    return self.model.test_step(batch)
"
2025-10-23 01:52:33.675154+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 01:52:33.675863+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 01:52:33.676706+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 01:52:33.677510+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    results = self(**data, mode=mode)
"
2025-10-23 01:52:33.678622+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:52:33.679321+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:52:33.680133+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 01:52:33.680939+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    return self.predict(inputs, data_samples)
"
2025-10-23 01:52:33.681616+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 01:52:33.682233+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 01:52:33.682826+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 01:52:33.683407+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    x = self.backbone(batch_inputs)
"
2025-10-23 01:52:33.723739+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:52:33.726121+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:52:33.728666+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 01:52:33.730908+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    x = blk(x)
"
2025-10-23 01:52:33.733371+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:52:33.735720+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:52:33.737321+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 01:52:33.739177+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    x = self.attn(x)
"
2025-10-23 01:52:33.740867+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:52:33.742434+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:52:33.744335+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 01:52:33.745938+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 01:52:33.747322+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 01:52:33.749014+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 01:52:33.750546+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 01:52:33.751942+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,"[0m
"
2025-10-23 01:52:40.858354+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d889-76ef-9b07-bb543d4e315d,Finished in state Completed()
2025-10-23 01:52:47.946227+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d88d-73ed-9f86-753fa0da454d,"{'msg': 'Traceback (most recent call last):\n  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference\n    result = self.predict(data)\n  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context\n    return func(*args, **kwargs)\n  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict\n    return self.model.test_step(batch)\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step\n    return self._run_forward(data, mode=\'predict\')  # type: ignore\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward\n    results = self(**data, mode=mode)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward\n    return self.predict(inputs, data_samples)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict\n    x = self.extract_feat(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat\n    x = self.backbone(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward\n    x = blk(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward\n    x = self.attn(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward\n    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos\n    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504\nRuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)\n', 'retriable': False}"
2025-10-23 01:52:47.952364+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d88d-73ed-9f86-753fa0da454d,Inference was failed. See the logs for detail.
2025-10-23 01:52:47.954489+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d88d-73ed-9f86-753fa0da454d,"Task run failed with exception: InferenceFailError() - No retries configured for this task.
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 01:52:47.969467+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec3-d88d-73ed-9f86-753fa0da454d,Finished in state Failed('Task run encountered an exception InferenceFailError: ')
2025-10-23 01:52:47.980542+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Encountered exception during execution: InferenceFailError()
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 01:52:48.034692+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Finished in state Failed('Flow run encountered an exception: InferenceFailError: ')
2025-10-23 01:52:48.037487+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Engine execution exited with unexpected exception
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1554, in run_flow
    ret_val = run_flow_sync(**kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1399, in run_flow_sync
    return engine.state if return_type == ""state"" else engine.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 361, in result
    raise self._raised
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 01:52:48.614562+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Process for flow run 'hilarious-gazelle' exited with status code: 1
2025-10-23 01:53:53.134507+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Worker 'KubernetesWorker a05e490e-9eac-4523-9166-1b04920e6d58' submitting flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 01:53:53.296206+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Creating Kubernetes job...
2025-10-23 01:53:53.504964+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Completed submission of flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 01:53:59.651309+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Opening process...
2025-10-23 01:54:02.348916+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,, > Running git_clone step...
2025-10-23 01:54:07.889526+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Beginning flow run 'hilarious-gazelle' for flow 'run-modint-flow'
2025-10-23 01:54:08.036445+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fdb4-726a-98d4-561db9f8ffdd,This job ID will be used - modint-prefect-hilarious-gazelle-6
2025-10-23 01:54:08.042408+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fdb4-726a-98d4-561db9f8ffdd,Finished in state Completed()
2025-10-23 01:54:08.555726+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2d-7f07-9042-f6fc3f9d0183,Finished in state Completed()
2025-10-23 01:54:08.596846+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe30-787d-b420-9f7bafd33421,{'scene_path': '/nas/Dataset/securewatch/geofocus/20240110_50cm_Hamju/050195143010_01/050195143010_01_P001_PSH/23NOV22020447-S2AS-050195143010_01_P001.TIF'}
2025-10-23 01:54:08.686337+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec6-009c-74ee-977c-aad03850dd5d,Finished in state Completed()
2025-10-23 01:54:09.459801+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,Beginning subflow run 'steadfast-toucan' for flow 'run-namespaced-job'
2025-10-23 01:54:17.580807+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"Downloading artifacts:   0%|          | 0/13 [00:00<?, ?it/s]2025/10/23 01:54:17 INFO mlflow.store.artifact.artifact_repo: The progress bar can be disabled by setting the environment variable MLFLOW_ENABLE_ARTIFACTS_PROGRESS_BAR to false
"
2025-10-23 01:54:54.253455+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"Loads checkpoint by local backend from path: /tmp/tmp1klxvfxn/checkpoint/model_final.pth
"
2025-10-23 01:54:54.255948+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"Downloading artifacts:   8%|â–Š         | 1/13 [00:00<00:00, 196.45it/s]Downloading artifacts:  15%|â–ˆâ–Œ        | 2/13 [00:00<00:00, 368.12it/s]Downloading artifacts:  23%|â–ˆâ–ˆâ–Ž       | 3/13 [00:00<00:00, 529.74it/s]Downloading artifacts:  31%|â–ˆâ–ˆâ–ˆ       | 4/13 [00:00<00:00, 681.53it/s]Downloading artifacts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 5/13 [00:00<00:00, 823.64it/s]Downloading artifacts:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 6/13 [00:00<00:00, 237.43it/s]Downloading artifacts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 7/13 [00:00<00:00, 266.64it/s]Downloading artifacts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 8/13 [00:00<00:00, 271.43it/s]Downloading artifacts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 9/13 [00:00<00:00, 280.04it/s]Downloading artifacts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 10/13 [00:00<00:00, 224.79it/s]Downloading artifacts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 153.62it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 134.95it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00,  1.12s/it] Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00,  1.12s/it]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00,  1.12s/it]
"
2025-10-23 01:54:55.436692+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"Making patches:   0%|          | 0/1 [00:00<?, ?it/s]Making patches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 11650.84it/s]
"
2025-10-23 01:54:56.914908+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"2025-10-23 01:54:56.920 | ERROR    | modint.runner.base_runner:inference:137 - An exception occurred:
"
2025-10-23 01:54:56.917515+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"Traceback (most recent call last):
"
2025-10-23 01:54:56.919698+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 01:54:56.921945+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    result = self.predict(data)
"
2025-10-23 01:54:56.923833+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 01:54:56.925707+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    return func(*args, **kwargs)
"
2025-10-23 01:54:56.927801+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 01:54:56.929812+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    return self.model.test_step(batch)
"
2025-10-23 01:54:56.931683+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 01:54:56.933366+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 01:54:56.934985+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 01:54:56.936903+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    results = self(**data, mode=mode)
"
2025-10-23 01:54:56.938903+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:54:56.942026+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:54:56.944006+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 01:54:56.948174+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    return self.predict(inputs, data_samples)
"
2025-10-23 01:54:56.949646+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 01:54:56.950929+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 01:54:56.952444+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 01:54:56.953797+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    x = self.backbone(batch_inputs)
"
2025-10-23 01:54:56.955687+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:54:56.956782+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:54:56.958550+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 01:54:56.959663+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    x = blk(x)
"
2025-10-23 01:54:56.960481+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:54:56.961272+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:54:56.962048+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 01:54:56.962833+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    x = self.attn(x)
"
2025-10-23 01:54:56.963596+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:54:56.964398+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:54:56.965175+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 01:54:56.965950+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 01:54:56.966717+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 01:54:56.967486+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 01:54:56.968487+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 01:54:56.969639+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"
"
2025-10-23 01:54:56.970454+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"[32m2025-10-23T01:54:56.920639+0000[0m [31m[1mAn exception occurred:
"
2025-10-23 01:54:56.971256+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"Traceback (most recent call last):
"
2025-10-23 01:54:56.972297+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 01:54:56.973107+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    result = self.predict(data)
"
2025-10-23 01:54:56.973882+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 01:54:56.974952+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    return func(*args, **kwargs)
"
2025-10-23 01:54:56.975735+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 01:54:56.976545+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    return self.model.test_step(batch)
"
2025-10-23 01:54:56.977625+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 01:54:56.978416+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 01:54:56.979216+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 01:54:56.980125+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    results = self(**data, mode=mode)
"
2025-10-23 01:54:56.980761+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:54:56.981380+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:54:56.981968+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 01:54:56.982560+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    return self.predict(inputs, data_samples)
"
2025-10-23 01:54:56.983138+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 01:54:56.983729+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 01:54:57.024781+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 01:54:57.026982+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    x = self.backbone(batch_inputs)
"
2025-10-23 01:54:57.029079+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:54:57.030969+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:54:57.032601+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 01:54:57.034626+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    x = blk(x)
"
2025-10-23 01:54:57.036545+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:54:57.038371+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:54:57.040276+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 01:54:57.042015+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    x = self.attn(x)
"
2025-10-23 01:54:57.043677+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:54:57.045265+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:54:57.046765+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 01:54:57.048470+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 01:54:57.049993+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 01:54:57.051272+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 01:54:57.052865+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 01:54:57.054320+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,"[0m
"
2025-10-23 01:55:07.199557+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe2e-772c-9b2a-0ded6f982d5e,Finished in state Completed()
2025-10-23 01:55:08.673596+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe30-787d-b420-9f7bafd33421,"{'msg': 'Traceback (most recent call last):\n  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference\n    result = self.predict(data)\n  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context\n    return func(*args, **kwargs)\n  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict\n    return self.model.test_step(batch)\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step\n    return self._run_forward(data, mode=\'predict\')  # type: ignore\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward\n    results = self(**data, mode=mode)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward\n    return self.predict(inputs, data_samples)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict\n    x = self.extract_feat(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat\n    x = self.backbone(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward\n    x = blk(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward\n    x = self.attn(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward\n    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos\n    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504\nRuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)\n', 'retriable': False}"
2025-10-23 01:55:08.679650+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe30-787d-b420-9f7bafd33421,Inference was failed. See the logs for detail.
2025-10-23 01:55:08.681715+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe30-787d-b420-9f7bafd33421,"Task run failed with exception: InferenceFailError() - No retries configured for this task.
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 01:55:08.696643+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec5-fe30-787d-b420-9f7bafd33421,Finished in state Failed('Task run encountered an exception InferenceFailError: ')
2025-10-23 01:55:08.706862+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Encountered exception during execution: InferenceFailError()
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 01:55:08.756021+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Finished in state Failed('Flow run encountered an exception: InferenceFailError: ')
2025-10-23 01:55:08.758635+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Engine execution exited with unexpected exception
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1554, in run_flow
    ret_val = run_flow_sync(**kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1399, in run_flow_sync
    return engine.state if return_type == ""state"" else engine.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 361, in result
    raise self._raised
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 01:55:09.353256+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Process for flow run 'hilarious-gazelle' exited with status code: 1
2025-10-23 01:55:15.683434+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Worker 'KubernetesWorker a05e490e-9eac-4523-9166-1b04920e6d58' submitting flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 01:55:15.843449+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Creating Kubernetes job...
2025-10-23 01:55:16.157555+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Completed submission of flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 01:55:22.388636+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Opening process...
2025-10-23 01:55:24.947737+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,, > Running git_clone step...
2025-10-23 01:55:31.101752+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Beginning flow run 'hilarious-gazelle' for flow 'run-modint-flow'
2025-10-23 01:55:31.284596+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-42c1-7fa0-8e6c-76b883a42890,This job ID will be used - modint-prefect-hilarious-gazelle-7
2025-10-23 01:55:31.289773+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-42c1-7fa0-8e6c-76b883a42890,Finished in state Completed()
2025-10-23 01:55:31.840352+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-71ff-82bd-84209551a288,Finished in state Completed()
2025-10-23 01:55:31.881613+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-437b-7080-a0b6-8d05a88911b2,{'scene_path': '/nas/Dataset/securewatch/geofocus/20240110_50cm_Hamju/050195143010_01/050195143010_01_P001_PSH/23NOV22020447-S2AS-050195143010_01_P001.TIF'}
2025-10-23 01:55:31.994879+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-45fc-7f17-8ca7-9a632acb9191,Finished in state Completed()
2025-10-23 01:55:33.120099+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,Beginning subflow run 'steadfast-toucan' for flow 'run-namespaced-job'
2025-10-23 01:55:40.708316+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"Downloading artifacts:   0%|          | 0/13 [00:00<?, ?it/s]2025/10/23 01:55:40 INFO mlflow.store.artifact.artifact_repo: The progress bar can be disabled by setting the environment variable MLFLOW_ENABLE_ARTIFACTS_PROGRESS_BAR to false
"
2025-10-23 01:56:14.963693+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"Loads checkpoint by local backend from path: /tmp/tmph81dvbj8/checkpoint/model_final.pth
"
2025-10-23 01:56:14.966100+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"Downloading artifacts:   8%|â–Š         | 1/13 [00:00<00:00, 1683.78it/s]Downloading artifacts:  15%|â–ˆâ–Œ        | 2/13 [00:00<00:00, 2087.24it/s]Downloading artifacts:  23%|â–ˆâ–ˆâ–Ž       | 3/13 [00:00<00:00, 188.81it/s] Downloading artifacts:  31%|â–ˆâ–ˆâ–ˆ       | 4/13 [00:00<00:00, 246.27it/s]Downloading artifacts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 5/13 [00:00<00:00, 303.43it/s]Downloading artifacts:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 6/13 [00:00<00:00, 359.51it/s]Downloading artifacts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 7/13 [00:00<00:00, 211.55it/s]Downloading artifacts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 8/13 [00:00<00:00, 200.28it/s]Downloading artifacts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 9/13 [00:00<00:00, 171.75it/s]Downloading artifacts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 10/13 [00:00<00:00, 186.34it/s]Downloading artifacts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 193.55it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 119.40it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 119.40it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00, 119.40it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00,  1.12s/it] 
"
2025-10-23 01:56:16.113122+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"Making patches:   0%|          | 0/1 [00:00<?, ?it/s]Making patches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 7943.76it/s]
"
2025-10-23 01:56:17.697675+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"2025-10-23 01:56:17.702 | ERROR    | modint.runner.base_runner:inference:137 - An exception occurred:
"
2025-10-23 01:56:17.700339+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"Traceback (most recent call last):
"
2025-10-23 01:56:17.702343+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 01:56:17.704594+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    result = self.predict(data)
"
2025-10-23 01:56:17.706652+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 01:56:17.708631+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    return func(*args, **kwargs)
"
2025-10-23 01:56:17.711198+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 01:56:17.713080+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    return self.model.test_step(batch)
"
2025-10-23 01:56:17.715084+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 01:56:17.717065+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 01:56:17.718847+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 01:56:17.720886+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    results = self(**data, mode=mode)
"
2025-10-23 01:56:17.722715+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:56:17.724224+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:56:17.725919+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 01:56:17.727573+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    return self.predict(inputs, data_samples)
"
2025-10-23 01:56:17.729000+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 01:56:17.730713+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 01:56:17.735269+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 01:56:17.736870+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    x = self.backbone(batch_inputs)
"
2025-10-23 01:56:17.738353+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:56:17.740004+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:56:17.741555+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 01:56:17.742926+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    x = blk(x)
"
2025-10-23 01:56:17.743990+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:56:17.745339+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:56:17.746902+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 01:56:17.748428+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    x = self.attn(x)
"
2025-10-23 01:56:17.749901+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:56:17.751532+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:56:17.752993+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 01:56:17.754148+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 01:56:17.755585+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 01:56:17.756977+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 01:56:17.758141+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 01:56:17.759605+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"
"
2025-10-23 01:56:17.760954+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"[32m2025-10-23T01:56:17.702258+0000[0m [31m[1mAn exception occurred:
"
2025-10-23 01:56:17.762129+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"Traceback (most recent call last):
"
2025-10-23 01:56:17.763448+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 01:56:17.764767+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    result = self.predict(data)
"
2025-10-23 01:56:17.765836+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 01:56:17.767165+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    return func(*args, **kwargs)
"
2025-10-23 01:56:17.768338+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 01:56:17.769408+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    return self.model.test_step(batch)
"
2025-10-23 01:56:17.770722+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 01:56:17.771912+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 01:56:17.772932+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 01:56:17.774172+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    results = self(**data, mode=mode)
"
2025-10-23 01:56:17.775230+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:56:17.776013+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:56:17.776741+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 01:56:17.777633+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    return self.predict(inputs, data_samples)
"
2025-10-23 01:56:17.778839+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 01:56:17.822644+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 01:56:17.824507+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 01:56:17.826674+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    x = self.backbone(batch_inputs)
"
2025-10-23 01:56:17.828746+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:56:17.830671+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:56:17.832829+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 01:56:17.834745+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    x = blk(x)
"
2025-10-23 01:56:17.836513+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:56:17.838518+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:56:17.840447+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 01:56:17.842158+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    x = self.attn(x)
"
2025-10-23 01:56:17.843840+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 01:56:17.845415+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    return forward_call(*input, **kwargs)
"
2025-10-23 01:56:17.846884+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 01:56:17.848604+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 01:56:17.850238+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 01:56:17.851665+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 01:56:17.853278+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 01:56:17.854787+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,"[0m
"
2025-10-23 01:56:24.950839+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-435c-7937-b81f-ce8700f7c01f,Finished in state Completed()
2025-10-23 01:56:31.954658+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-437b-7080-a0b6-8d05a88911b2,"{'msg': 'Traceback (most recent call last):\n  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference\n    result = self.predict(data)\n  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context\n    return func(*args, **kwargs)\n  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict\n    return self.model.test_step(batch)\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step\n    return self._run_forward(data, mode=\'predict\')  # type: ignore\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward\n    results = self(**data, mode=mode)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward\n    return self.predict(inputs, data_samples)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict\n    x = self.extract_feat(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat\n    x = self.backbone(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward\n    x = blk(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward\n    x = self.attn(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward\n    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos\n    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504\nRuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)\n', 'retriable': False}"
2025-10-23 01:56:31.961227+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-437b-7080-a0b6-8d05a88911b2,Inference was failed. See the logs for detail.
2025-10-23 01:56:31.963399+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-437b-7080-a0b6-8d05a88911b2,"Task run failed with exception: InferenceFailError() - No retries configured for this task.
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 01:56:31.978222+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ec7-437b-7080-a0b6-8d05a88911b2,Finished in state Failed('Task run encountered an exception InferenceFailError: ')
2025-10-23 01:56:31.987936+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Encountered exception during execution: InferenceFailError()
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 01:56:32.044394+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Finished in state Failed('Flow run encountered an exception: InferenceFailError: ')
2025-10-23 01:56:32.047054+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Engine execution exited with unexpected exception
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1554, in run_flow
    ret_val = run_flow_sync(**kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1399, in run_flow_sync
    return engine.state if return_type == ""state"" else engine.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 361, in result
    raise self._raised
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 01:56:32.793026+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Process for flow run 'hilarious-gazelle' exited with status code: 1
2025-10-23 02:03:32.722007+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Worker 'KubernetesWorker a05e490e-9eac-4523-9166-1b04920e6d58' submitting flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 02:03:32.895207+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Creating Kubernetes job...
2025-10-23 02:03:33.099334+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Completed submission of flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 02:03:39.074449+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Opening process...
2025-10-23 02:03:41.785208+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,, > Running git_clone step...
2025-10-23 02:03:47.644171+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Beginning flow run 'hilarious-gazelle' for flow 'run-modint-flow'
2025-10-23 02:03:47.834083+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d65e-733a-95bc-8ffede772077,This job ID will be used - modint-prefect-hilarious-gazelle-8
2025-10-23 02:03:47.840124+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d65e-733a-95bc-8ffede772077,Finished in state Completed()
2025-10-23 02:03:48.383882+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-7121-8d6d-e8478b69cc7b,Finished in state Completed()
2025-10-23 02:03:48.437743+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d706-7484-938c-411608833ab2,{'scene_path': '/nas/Dataset/securewatch/geofocus/20240110_50cm_Hamju/050195143010_01/050195143010_01_P001_PSH/23NOV22020447-S2AS-050195143010_01_P001.TIF'}
2025-10-23 02:03:48.535176+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d97e-733c-a3b0-6b39e22c64e4,Finished in state Completed()
2025-10-23 02:03:49.477771+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,Beginning subflow run 'steadfast-toucan' for flow 'run-namespaced-job'
2025-10-23 02:03:57.166958+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,"Downloading artifacts:   0%|          | 0/13 [00:00<?, ?it/s]2025/10/23 02:03:57 INFO mlflow.store.artifact.artifact_repo: The progress bar can be disabled by setting the environment variable MLFLOW_ENABLE_ARTIFACTS_PROGRESS_BAR to false
"
2025-10-23 02:04:00.830129+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,"Downloading artifacts:   8%|â–Š         | 1/13 [00:00<00:00, 2654.62it/s]Downloading artifacts:  15%|â–ˆâ–Œ        | 2/13 [00:00<00:00, 3606.45it/s]Downloading artifacts:  23%|â–ˆâ–ˆâ–Ž       | 3/13 [00:00<00:00, 4454.13it/s]Downloading artifacts:  31%|â–ˆâ–ˆâ–ˆ       | 4/13 [00:00<00:00, 5091.72it/s]Downloading artifacts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 5/13 [00:00<00:00, 1053.69it/s]Downloading artifacts:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 6/13 [00:00<00:00, 1218.39it/s]Downloading artifacts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 7/13 [00:00<00:00, 828.66it/s] Downloading artifacts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 8/13 [00:00<00:00, 709.31it/s]Downloading artifacts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 9/13 [00:00<00:00, 377.44it/s]Downloading artifacts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 10/13 [00:00<00:00, 369.89it/s]Downloading artifacts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 354.42it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 173.73it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:03<00:00,  3.33it/s] 
"
2025-10-23 02:04:00.833594+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,"Traceback (most recent call last):
"
2025-10-23 02:04:00.835576+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,"  File ""tools/infer.py"", line 51, in <module>
"
2025-10-23 02:04:00.839798+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,"    asyncio.run(main())
"
2025-10-23 02:04:00.841944+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,"  File ""/usr/local/lib/python3.8/asyncio/runners.py"", line 43, in run
"
2025-10-23 02:04:00.843549+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,"    return loop.run_until_complete(main)
"
2025-10-23 02:04:00.844998+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,"  File ""/usr/local/lib/python3.8/asyncio/base_events.py"", line 616, in run_until_complete
"
2025-10-23 02:04:00.846452+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,"    return future.result()
"
2025-10-23 02:04:00.847870+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,"  File ""tools/infer.py"", line 38, in main
"
2025-10-23 02:04:00.849496+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,"    runner = DetectionRunner(
"
2025-10-23 02:04:00.851656+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,"  File ""/ardet/ardet/apis/det_runner.py"", line 22, in __init__
"
2025-10-23 02:04:00.854398+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,"    super().__init__(**kwarg)
"
2025-10-23 02:04:00.855872+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 24, in __init__
"
2025-10-23 02:04:00.856967+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,"    self.model = self.init_model(run_id, artifact_path)
"
2025-10-23 02:04:00.858042+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,"  File ""/ardet/ardet/apis/det_runner.py"", line 54, in init_model
"
2025-10-23 02:04:00.859041+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,"    artifact_path = mlflow.artifacts.download_artifacts(
"
2025-10-23 02:04:00.860655+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,"  File ""/usr/local/lib/python3.8/site-packages/mlflow/artifacts/__init__.py"", line 69, in download_artifacts
"
2025-10-23 02:04:00.862413+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,"    return artifact_repo.download_artifacts(artifact_path, dst_path=dst_path)
"
2025-10-23 02:04:00.863424+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,"  File ""/usr/local/lib/python3.8/site-packages/mlflow/store/artifact/artifact_repo.py"", line 220, in download_artifacts
"
2025-10-23 02:04:00.864294+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,"    raise MlflowException(
"
2025-10-23 02:04:00.865069+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,"mlflow.exceptions.MlflowException: The following failures occurred while downloading one or more artifacts from s3://mlflow/317/da9da9d0a8fa463aaff37660dc62f84b/artifacts:
"
2025-10-23 02:04:00.865904+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,"##### File checkpoint/model_final.pth #####
"
2025-10-23 02:04:00.866684+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,"An error occurred while reading from response stream: (""Connection broken: ConnectionResetError(104, 'Connection reset by peer')"", ConnectionResetError(104, 'Connection reset by peer'))
"
2025-10-23 02:04:57.859152+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d703-791f-87f2-49e81f864ff6,Finished in state Completed()
2025-10-23 02:05:18.531573+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d706-7484-938c-411608833ab2,"{'msg': 'Traceback (most recent call last):\n  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference\n    result = self.predict(data)\n  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context\n    return func(*args, **kwargs)\n  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict\n    return self.model.test_step(batch)\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step\n    return self._run_forward(data, mode=\'predict\')  # type: ignore\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward\n    results = self(**data, mode=mode)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward\n    return self.predict(inputs, data_samples)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict\n    x = self.extract_feat(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat\n    x = self.backbone(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward\n    x = blk(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward\n    x = self.attn(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward\n    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos\n    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504\nRuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)\n', 'retriable': False}"
2025-10-23 02:05:18.538348+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d706-7484-938c-411608833ab2,Inference was failed. See the logs for detail.
2025-10-23 02:05:18.540586+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d706-7484-938c-411608833ab2,"Task run failed with exception: InferenceFailError() - No retries configured for this task.
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 02:05:18.556031+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ece-d706-7484-938c-411608833ab2,Finished in state Failed('Task run encountered an exception InferenceFailError: ')
2025-10-23 02:05:18.565661+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Encountered exception during execution: InferenceFailError()
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 02:05:18.621904+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Finished in state Failed('Flow run encountered an exception: InferenceFailError: ')
2025-10-23 02:05:18.625127+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Engine execution exited with unexpected exception
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1554, in run_flow
    ret_val = run_flow_sync(**kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1399, in run_flow_sync
    return engine.state if return_type == ""state"" else engine.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 361, in result
    raise self._raised
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 02:05:19.324187+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Process for flow run 'hilarious-gazelle' exited with status code: 1
2025-10-23 02:06:31.464242+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Worker 'KubernetesWorker a05e490e-9eac-4523-9166-1b04920e6d58' submitting flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 02:06:31.653593+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Creating Kubernetes job...
2025-10-23 02:06:31.877156+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Completed submission of flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 02:06:38.087101+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Opening process...
2025-10-23 02:06:40.673832+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,, > Running git_clone step...
2025-10-23 02:06:46.278080+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Beginning flow run 'hilarious-gazelle' for flow 'run-modint-flow'
2025-10-23 02:06:46.394516+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-902a-7235-a285-1e941fb2b7ea,This job ID will be used - modint-prefect-hilarious-gazelle-9
2025-10-23 02:06:46.427209+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-902a-7235-a285-1e941fb2b7ea,Finished in state Completed()
2025-10-23 02:06:46.983868+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909e-75d9-ad56-632ea5e0119b,Finished in state Completed()
2025-10-23 02:06:47.038560+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-90a2-79ce-8f30-b98d477e914d,{'scene_path': '/nas/Dataset/securewatch/geofocus/20240110_50cm_Hamju/050195143010_01/050195143010_01_P001_PSH/23NOV22020447-S2AS-050195143010_01_P001.TIF'}
2025-10-23 02:06:47.136189+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-9332-7685-b4a9-d22baa3cdf55,Finished in state Completed()
2025-10-23 02:06:47.970880+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,Beginning subflow run 'steadfast-toucan' for flow 'run-namespaced-job'
2025-10-23 02:06:56.481427+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"Downloading artifacts:   0%|          | 0/13 [00:00<?, ?it/s]2025/10/23 02:06:56 INFO mlflow.store.artifact.artifact_repo: The progress bar can be disabled by setting the environment variable MLFLOW_ENABLE_ARTIFACTS_PROGRESS_BAR to false
"
2025-10-23 02:07:35.245132+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"Downloading artifacts:   8%|â–Š         | 1/13 [00:00<00:00, 180.63it/s]Downloading artifacts:  15%|â–ˆâ–Œ        | 2/13 [00:00<00:00, 242.28it/s]Downloading artifacts:  23%|â–ˆâ–ˆâ–Ž       | 3/13 [00:00<00:00, 282.05it/s]Downloading artifacts:  31%|â–ˆâ–ˆâ–ˆ       | 4/13 [00:00<00:00, 340.64it/s]Downloading artifacts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 5/13 [00:00<00:00, 401.55it/s]Downloading artifacts:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 6/13 [00:00<00:00, 396.02it/s]Downloading artifacts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 7/13 [00:00<00:00, 441.57it/s]Downloading artifacts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 8/13 [00:00<00:00, 488.82it/s]Downloading artifacts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 9/13 [00:00<00:00, 533.08it/s]Downloading artifacts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 10/13 [00:00<00:00, 114.48it/s]Downloading artifacts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 77.80it/s] Downloading artifacts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 77.80it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 77.80it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:15<00:00, 77.80it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:15<00:00,  1.17s/it]
"
2025-10-23 02:07:35.249238+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"Loads checkpoint by local backend from path: /tmp/tmpiq_n48__/checkpoint/model_final.pth
"
2025-10-23 02:07:36.914975+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"Making patches:   0%|          | 0/1 [00:00<?, ?it/s]Making patches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 7839.82it/s]
"
2025-10-23 02:07:38.459447+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"2025-10-23 02:07:38.461 | ERROR    | modint.runner.base_runner:inference:137 - An exception occurred:
"
2025-10-23 02:07:38.461694+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"Traceback (most recent call last):
"
2025-10-23 02:07:38.463696+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 02:07:38.465800+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    result = self.predict(data)
"
2025-10-23 02:07:38.470615+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 02:07:38.473901+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    return func(*args, **kwargs)
"
2025-10-23 02:07:38.475587+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 02:07:38.477449+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    return self.model.test_step(batch)
"
2025-10-23 02:07:38.479243+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 02:07:38.481482+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 02:07:38.483642+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 02:07:38.485311+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    results = self(**data, mode=mode)
"
2025-10-23 02:07:38.486548+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:07:38.487804+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:07:38.489058+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 02:07:38.490336+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    return self.predict(inputs, data_samples)
"
2025-10-23 02:07:38.491574+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 02:07:38.493226+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 02:07:38.494710+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 02:07:38.495764+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    x = self.backbone(batch_inputs)
"
2025-10-23 02:07:38.497227+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:07:38.498201+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:07:38.499076+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 02:07:38.499972+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    x = blk(x)
"
2025-10-23 02:07:38.500837+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:07:38.501726+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:07:38.502601+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 02:07:38.504443+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    x = self.attn(x)
"
2025-10-23 02:07:38.505773+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:07:38.506956+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:07:38.508143+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 02:07:38.509318+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 02:07:38.510478+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 02:07:38.511647+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 02:07:38.512837+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 02:07:38.514047+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"
"
2025-10-23 02:07:38.515167+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"[32m2025-10-23T02:07:38.461949+0000[0m [31m[1mAn exception occurred:
"
2025-10-23 02:07:38.516187+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"Traceback (most recent call last):
"
2025-10-23 02:07:38.517204+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 02:07:38.518665+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    result = self.predict(data)
"
2025-10-23 02:07:38.519627+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 02:07:38.523818+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    return func(*args, **kwargs)
"
2025-10-23 02:07:38.524708+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 02:07:38.525514+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    return self.model.test_step(batch)
"
2025-10-23 02:07:38.526289+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 02:07:38.527076+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 02:07:38.527864+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 02:07:38.528668+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    results = self(**data, mode=mode)
"
2025-10-23 02:07:38.529436+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:07:38.530217+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:07:38.530984+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 02:07:38.531766+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    return self.predict(inputs, data_samples)
"
2025-10-23 02:07:38.532555+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 02:07:38.533337+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 02:07:38.534104+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 02:07:38.534888+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    x = self.backbone(batch_inputs)
"
2025-10-23 02:07:38.535581+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:07:38.536370+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:07:38.537322+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 02:07:38.539079+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    x = blk(x)
"
2025-10-23 02:07:38.540347+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:07:38.541575+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:07:38.542470+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 02:07:38.543652+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    x = self.attn(x)
"
2025-10-23 02:07:38.544887+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:07:38.545660+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:07:38.546301+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 02:07:38.546914+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 02:07:38.547707+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 02:07:38.548549+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 02:07:38.549680+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 02:07:38.550397+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,"[0m
"
2025-10-23 02:07:45.762601+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-909f-775d-ab07-758f045c1665,Finished in state Completed()
2025-10-23 02:07:47.088547+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-90a2-79ce-8f30-b98d477e914d,"{'msg': 'Traceback (most recent call last):\n  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference\n    result = self.predict(data)\n  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context\n    return func(*args, **kwargs)\n  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict\n    return self.model.test_step(batch)\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step\n    return self._run_forward(data, mode=\'predict\')  # type: ignore\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward\n    results = self(**data, mode=mode)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward\n    return self.predict(inputs, data_samples)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict\n    x = self.extract_feat(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat\n    x = self.backbone(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward\n    x = blk(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward\n    x = self.attn(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward\n    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos\n    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504\nRuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)\n', 'retriable': False}"
2025-10-23 02:07:47.095667+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-90a2-79ce-8f30-b98d477e914d,Inference was failed. See the logs for detail.
2025-10-23 02:07:47.097836+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-90a2-79ce-8f30-b98d477e914d,"Task run failed with exception: InferenceFailError() - No retries configured for this task.
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 02:07:47.115357+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed1-90a2-79ce-8f30-b98d477e914d,Finished in state Failed('Task run encountered an exception InferenceFailError: ')
2025-10-23 02:07:47.125573+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Encountered exception during execution: InferenceFailError()
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 183, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 02:07:47.184515+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Finished in state Failed('Flow run encountered an exception: InferenceFailError: ')
2025-10-23 02:07:47.187208+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Engine execution exited with unexpected exception
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1554, in run_flow
    ret_val = run_flow_sync(**kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1399, in run_flow_sync
    return engine.state if return_type == ""state"" else engine.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 361, in result
    raise self._raised
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 183, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 02:07:47.953109+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Process for flow run 'hilarious-gazelle' exited with status code: 1
2025-10-23 02:08:35.306270+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Worker 'KubernetesWorker a05e490e-9eac-4523-9166-1b04920e6d58' submitting flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 02:08:35.524987+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Creating Kubernetes job...
2025-10-23 02:08:36.019530+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Completed submission of flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 02:08:42.780241+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Opening process...
2025-10-23 02:08:45.455117+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,, > Running git_clone step...
2025-10-23 02:08:51.007537+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Beginning flow run 'hilarious-gazelle' for flow 'run-modint-flow'
2025-10-23 02:08:51.177101+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-7761-7d52-965b-1783ef2b3b6a,This job ID will be used - modint-prefect-hilarious-gazelle-10
2025-10-23 02:08:51.179841+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-7761-7d52-965b-1783ef2b3b6a,Finished in state Completed()
2025-10-23 02:08:51.689484+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-7dc9-8ff1-2d1839d30119,Finished in state Completed()
2025-10-23 02:08:51.757438+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ef-74c8-8dc9-bd514ad286ab,{'scene_path': '/nas/Dataset/securewatch/geofocus/20240110_50cm_Hamju/050195143010_01/050195143010_01_P001_PSH/23NOV22020447-S2AS-050195143010_01_P001.TIF'}
2025-10-23 02:08:51.852322+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-7a5b-78b6-8234-35504e271cbb,Finished in state Completed()
2025-10-23 02:08:52.621701+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,Beginning subflow run 'steadfast-toucan' for flow 'run-namespaced-job'
2025-10-23 02:09:00.749830+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"Downloading artifacts:   0%|          | 0/13 [00:00<?, ?it/s]2025/10/23 02:09:00 INFO mlflow.store.artifact.artifact_repo: The progress bar can be disabled by setting the environment variable MLFLOW_ENABLE_ARTIFACTS_PROGRESS_BAR to false
"
2025-10-23 02:09:43.499488+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"Loads checkpoint by local backend from path: /tmp/tmp9qcwoulf/checkpoint/model_final.pth
"
2025-10-23 02:09:43.501643+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"Downloading artifacts:   8%|â–Š         | 1/13 [00:00<00:00, 136.77it/s]Downloading artifacts:  15%|â–ˆâ–Œ        | 2/13 [00:00<00:00, 178.61it/s]Downloading artifacts:  23%|â–ˆâ–ˆâ–Ž       | 3/13 [00:00<00:00, 186.86it/s]Downloading artifacts:  31%|â–ˆâ–ˆâ–ˆ       | 4/13 [00:00<00:00, 223.50it/s]Downloading artifacts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 5/13 [00:00<00:00, 227.00it/s]Downloading artifacts:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 6/13 [00:00<00:00, 268.32it/s]Downloading artifacts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 7/13 [00:00<00:00, 230.08it/s]Downloading artifacts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 8/13 [00:00<00:00, 232.92it/s]Downloading artifacts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 9/13 [00:00<00:00, 201.80it/s]Downloading artifacts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 10/13 [00:00<00:00, 222.49it/s]Downloading artifacts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 206.83it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 122.17it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:15<00:00,  1.17s/it] Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:15<00:00,  1.17s/it]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:15<00:00,  1.17s/it]
"
2025-10-23 02:09:44.714196+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"Making patches:   0%|          | 0/1 [00:00<?, ?it/s]Making patches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 8665.92it/s]
"
2025-10-23 02:09:46.277781+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"2025-10-23 02:09:46.280 | ERROR    | modint.runner.base_runner:inference:137 - An exception occurred:
"
2025-10-23 02:09:46.279977+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"Traceback (most recent call last):
"
2025-10-23 02:09:46.281977+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 02:09:46.283957+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    result = self.predict(data)
"
2025-10-23 02:09:46.286148+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 02:09:46.288415+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    return func(*args, **kwargs)
"
2025-10-23 02:09:46.290647+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 02:09:46.292803+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    return self.model.test_step(batch)
"
2025-10-23 02:09:46.297252+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 02:09:46.299192+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 02:09:46.301092+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 02:09:46.302773+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    results = self(**data, mode=mode)
"
2025-10-23 02:09:46.304611+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:09:46.306499+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:09:46.308085+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 02:09:46.309979+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    return self.predict(inputs, data_samples)
"
2025-10-23 02:09:46.311753+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 02:09:46.313385+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 02:09:46.315018+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 02:09:46.316632+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    x = self.backbone(batch_inputs)
"
2025-10-23 02:09:46.317973+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:09:46.319603+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:09:46.321130+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 02:09:46.322482+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    x = blk(x)
"
2025-10-23 02:09:46.324011+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:09:46.325346+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:09:46.326521+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 02:09:46.327981+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    x = self.attn(x)
"
2025-10-23 02:09:46.329318+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:09:46.330508+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:09:46.331921+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 02:09:46.333380+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 02:09:46.334513+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 02:09:46.335902+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 02:09:46.337262+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 02:09:46.338412+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"
"
2025-10-23 02:09:46.339730+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"[32m2025-10-23T02:09:46.280551+0000[0m [31m[1mAn exception occurred:
"
2025-10-23 02:09:46.341125+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"Traceback (most recent call last):
"
2025-10-23 02:09:46.342227+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 02:09:46.343581+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    result = self.predict(data)
"
2025-10-23 02:09:46.344878+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 02:09:46.345928+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    return func(*args, **kwargs)
"
2025-10-23 02:09:46.347196+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 02:09:46.348376+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    return self.model.test_step(batch)
"
2025-10-23 02:09:46.349428+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 02:09:46.350710+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 02:09:46.351902+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 02:09:46.352965+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    results = self(**data, mode=mode)
"
2025-10-23 02:09:46.353796+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:09:46.355018+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:09:46.356153+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 02:09:46.357156+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    return self.predict(inputs, data_samples)
"
2025-10-23 02:09:46.358364+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 02:09:46.359486+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 02:09:46.360477+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 02:09:46.361703+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    x = self.backbone(batch_inputs)
"
2025-10-23 02:09:46.362811+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:09:46.363752+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:09:46.364451+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 02:09:46.365110+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    x = blk(x)
"
2025-10-23 02:09:46.365744+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:09:46.366407+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:09:46.367059+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 02:09:46.367696+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    x = self.attn(x)
"
2025-10-23 02:09:46.368721+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:09:46.369806+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:09:46.370892+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 02:09:46.372004+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 02:09:46.373094+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 02:09:46.374232+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 02:09:46.375317+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 02:09:46.376434+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,"[0m
"
2025-10-23 02:09:51.799829+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ef-74c8-8dc9-bd514ad286ab,"{'msg': 'Traceback (most recent call last):\n  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference\n    result = self.predict(data)\n  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context\n    return func(*args, **kwargs)\n  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict\n    return self.model.test_step(batch)\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step\n    return self._run_forward(data, mode=\'predict\')  # type: ignore\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward\n    results = self(**data, mode=mode)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward\n    return self.predict(inputs, data_samples)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict\n    x = self.extract_feat(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat\n    x = self.backbone(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward\n    x = blk(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward\n    x = self.attn(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward\n    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos\n    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504\nRuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)\n', 'retriable': False}"
2025-10-23 02:09:51.806048+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ef-74c8-8dc9-bd514ad286ab,Inference was failed. See the logs for detail.
2025-10-23 02:09:51.808164+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ef-74c8-8dc9-bd514ad286ab,"Task run failed with exception: InferenceFailError() - No retries configured for this task.
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 02:09:51.823086+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ef-74c8-8dc9-bd514ad286ab,Finished in state Failed('Task run encountered an exception InferenceFailError: ')
2025-10-23 02:09:56.649942+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed3-77ed-74c7-8c74-688b7fa5e77f,Finished in state Completed()
2025-10-23 02:09:56.660633+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Encountered exception during execution: InferenceFailError()
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 02:09:56.739204+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Finished in state Failed('Flow run encountered an exception: InferenceFailError: ')
2025-10-23 02:09:56.741870+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Engine execution exited with unexpected exception
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1554, in run_flow
    ret_val = run_flow_sync(**kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1399, in run_flow_sync
    return engine.state if return_type == ""state"" else engine.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 361, in result
    raise self._raised
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 02:09:57.417444+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Process for flow run 'hilarious-gazelle' exited with status code: 1
2025-10-23 02:13:13.334169+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Worker 'KubernetesWorker a05e490e-9eac-4523-9166-1b04920e6d58' submitting flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 02:13:13.552964+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Creating Kubernetes job...
2025-10-23 02:13:13.776783+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Completed submission of flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 02:13:20.018886+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Opening process...
2025-10-23 02:13:22.697544+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,, > Running git_clone step...
2025-10-23 02:13:28.283645+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Beginning flow run 'hilarious-gazelle' for flow 'run-modint-flow'
2025-10-23 02:13:28.437438+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b27f-7674-9cf0-e7c0a7201343,This job ID will be used - modint-prefect-hilarious-gazelle-11
2025-10-23 02:13:28.443298+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b27f-7674-9cf0-e7c0a7201343,Finished in state Completed()
2025-10-23 02:13:28.873405+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2fe-7bf8-bcb7-2441e256da80,Finished in state Completed()
2025-10-23 02:13:28.961859+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b301-78ac-ab05-ed52cfd85389,{'scene_path': '/nas/Dataset/securewatch/geofocus/20240110_50cm_Hamju/050195143010_01/050195143010_01_P001_PSH/23NOV22020447-S2AS-050195143010_01_P001.TIF'}
2025-10-23 02:13:29.083147+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b55b-742a-84d4-46452d16ca31,Finished in state Completed()
2025-10-23 02:13:29.969645+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,Beginning subflow run 'steadfast-toucan' for flow 'run-namespaced-job'
2025-10-23 02:13:38.625374+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"Downloading artifacts:   0%|          | 0/13 [00:00<?, ?it/s]2025/10/23 02:13:38 INFO mlflow.store.artifact.artifact_repo: The progress bar can be disabled by setting the environment variable MLFLOW_ENABLE_ARTIFACTS_PROGRESS_BAR to false
"
2025-10-23 02:14:19.888835+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"Loads checkpoint by local backend from path: /tmp/tmpei2a1ikg/checkpoint/model_final.pth
"
2025-10-23 02:14:19.891165+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"Downloading artifacts:   8%|â–Š         | 1/13 [00:00<00:00, 902.58it/s]Downloading artifacts:  15%|â–ˆâ–Œ        | 2/13 [00:00<00:00, 820.16it/s]Downloading artifacts:  23%|â–ˆâ–ˆâ–Ž       | 3/13 [00:00<00:00, 980.66it/s]Downloading artifacts:  31%|â–ˆâ–ˆâ–ˆ       | 4/13 [00:00<00:00, 1081.15it/s]Downloading artifacts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 5/13 [00:00<00:00, 1169.18it/s]Downloading artifacts:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 6/13 [00:00<00:00, 1247.56it/s]Downloading artifacts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 7/13 [00:00<00:00, 1324.26it/s]Downloading artifacts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 8/13 [00:00<00:00, 1206.39it/s]Downloading artifacts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 9/13 [00:00<00:00, 118.21it/s] Downloading artifacts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 10/13 [00:00<00:00, 125.27it/s]Downloading artifacts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 132.60it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 134.45it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00,  1.13s/it] Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00,  1.13s/it]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00,  1.13s/it]
"
2025-10-23 02:14:21.161165+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"Making patches:   0%|          | 0/1 [00:00<?, ?it/s]Making patches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 9822.73it/s]
"
2025-10-23 02:14:22.850329+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"2025-10-23 02:14:22.852 | ERROR    | modint.runner.base_runner:inference:137 - An exception occurred:
"
2025-10-23 02:14:22.852885+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"Traceback (most recent call last):
"
2025-10-23 02:14:22.854934+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 02:14:22.856916+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    result = self.predict(data)
"
2025-10-23 02:14:22.859046+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 02:14:22.861042+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    return func(*args, **kwargs)
"
2025-10-23 02:14:22.862823+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 02:14:22.867041+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    return self.model.test_step(batch)
"
2025-10-23 02:14:22.868817+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 02:14:22.870712+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 02:14:22.873137+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 02:14:22.874823+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    results = self(**data, mode=mode)
"
2025-10-23 02:14:22.876721+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:14:22.878528+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:14:22.880015+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 02:14:22.881727+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    return self.predict(inputs, data_samples)
"
2025-10-23 02:14:22.883347+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 02:14:22.884799+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 02:14:22.886478+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 02:14:22.888148+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    x = self.backbone(batch_inputs)
"
2025-10-23 02:14:22.889471+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:14:22.891050+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:14:22.892560+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 02:14:22.893913+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    x = blk(x)
"
2025-10-23 02:14:22.895409+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:14:22.896936+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:14:22.898293+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 02:14:22.899874+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    x = self.attn(x)
"
2025-10-23 02:14:22.901224+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:14:22.902426+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:14:22.903946+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 02:14:22.905301+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 02:14:22.906495+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 02:14:22.908037+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 02:14:22.909378+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 02:14:22.910474+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"
"
2025-10-23 02:14:22.922605+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"[32m2025-10-23T02:14:22.852482+0000[0m [31m[1mAn exception occurred:
"
2025-10-23 02:14:22.924233+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"Traceback (most recent call last):
"
2025-10-23 02:14:22.925850+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 02:14:22.927158+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    result = self.predict(data)
"
2025-10-23 02:14:22.928281+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 02:14:22.929899+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    return func(*args, **kwargs)
"
2025-10-23 02:14:22.931799+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 02:14:22.933551+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    return self.model.test_step(batch)
"
2025-10-23 02:14:22.935349+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 02:14:22.937308+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 02:14:22.939060+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 02:14:22.941241+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    results = self(**data, mode=mode)
"
2025-10-23 02:14:22.942698+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:14:22.944477+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:14:22.946111+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 02:14:22.947313+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    return self.predict(inputs, data_samples)
"
2025-10-23 02:14:22.948724+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 02:14:22.950516+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 02:14:22.951947+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 02:14:22.953344+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    x = self.backbone(batch_inputs)
"
2025-10-23 02:14:22.954939+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:14:22.956416+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:14:22.957704+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 02:14:22.959299+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    x = blk(x)
"
2025-10-23 02:14:22.960672+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:14:22.961838+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:14:22.963173+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 02:14:22.964524+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    x = self.attn(x)
"
2025-10-23 02:14:22.965677+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:14:22.967029+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:14:22.968399+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 02:14:22.969785+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 02:14:22.971071+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 02:14:22.972112+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 02:14:22.972946+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 02:14:22.974048+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,"[0m
"
2025-10-23 02:14:29.035479+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b301-78ac-ab05-ed52cfd85389,"{'msg': 'Traceback (most recent call last):\n  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference\n    result = self.predict(data)\n  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context\n    return func(*args, **kwargs)\n  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict\n    return self.model.test_step(batch)\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step\n    return self._run_forward(data, mode=\'predict\')  # type: ignore\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward\n    results = self(**data, mode=mode)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward\n    return self.predict(inputs, data_samples)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict\n    x = self.extract_feat(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat\n    x = self.backbone(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward\n    x = blk(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward\n    x = self.attn(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward\n    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos\n    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504\nRuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)\n', 'retriable': False}"
2025-10-23 02:14:29.041813+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b301-78ac-ab05-ed52cfd85389,Inference was failed. See the logs for detail.
2025-10-23 02:14:29.043990+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b301-78ac-ab05-ed52cfd85389,"Task run failed with exception: InferenceFailError() - No retries configured for this task.
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 02:14:29.059105+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b301-78ac-ab05-ed52cfd85389,Finished in state Failed('Task run encountered an exception InferenceFailError: ')
2025-10-23 02:14:30.153286+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ed7-b2ff-73b7-aa76-ec444d6d2028,Finished in state Completed()
2025-10-23 02:14:30.162970+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Encountered exception during execution: InferenceFailError()
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 02:14:30.260214+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Finished in state Failed('Flow run encountered an exception: InferenceFailError: ')
2025-10-23 02:14:30.262827+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Engine execution exited with unexpected exception
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1554, in run_flow
    ret_val = run_flow_sync(**kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1399, in run_flow_sync
    return engine.state if return_type == ""state"" else engine.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 361, in result
    raise self._raised
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 02:14:30.994143+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Process for flow run 'hilarious-gazelle' exited with status code: 1
2025-10-23 02:22:21.051181+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Worker 'KubernetesWorker a05e490e-9eac-4523-9166-1b04920e6d58' submitting flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 02:22:21.230417+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Creating Kubernetes job...
2025-10-23 02:22:21.441262+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Completed submission of flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 02:22:27.851574+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Opening process...
2025-10-23 02:22:30.653343+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,, > Running git_clone step...
2025-10-23 02:22:37.867692+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Beginning flow run 'hilarious-gazelle' for flow 'run-modint-flow'
2025-10-23 02:22:38.043689+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-154e-7653-bfdf-6b6c5af08a1e,This job ID will be used - modint-prefect-hilarious-gazelle-12
2025-10-23 02:22:38.049684+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-154e-7653-bfdf-6b6c5af08a1e,Finished in state Completed()
2025-10-23 02:22:38.550375+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-7c6e-908f-170afa24c671,Finished in state Completed()
2025-10-23 02:22:38.589957+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e7-7908-b028-0cb36177616a,{'scene_path': '/nas/Dataset/securewatch/geofocus/20240110_50cm_Hamju/050195143010_01/050195143010_01_P001_PSH/23NOV22020447-S2AS-050195143010_01_P001.TIF'}
2025-10-23 02:22:38.704106+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-184f-73cc-aa4c-cce988dc3221,Finished in state Completed()
2025-10-23 02:22:39.569473+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,Beginning subflow run 'steadfast-toucan' for flow 'run-namespaced-job'
2025-10-23 02:22:47.883065+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"Downloading artifacts:   0%|          | 0/13 [00:00<?, ?it/s]2025/10/23 02:22:47 INFO mlflow.store.artifact.artifact_repo: The progress bar can be disabled by setting the environment variable MLFLOW_ENABLE_ARTIFACTS_PROGRESS_BAR to false
"
2025-10-23 02:23:23.216861+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"Downloading artifacts:   8%|â–Š         | 1/13 [00:00<00:00, 1830.77it/s]Downloading artifacts:  15%|â–ˆâ–Œ        | 2/13 [00:00<00:00, 2647.92it/s]Downloading artifacts:  23%|â–ˆâ–ˆâ–Ž       | 3/13 [00:00<00:00, 3372.53it/s]Downloading artifacts:  31%|â–ˆâ–ˆâ–ˆ       | 4/13 [00:00<00:00, 3938.31it/s]Downloading artifacts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 5/13 [00:00<00:00, 4372.71it/s]Downloading artifacts:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 6/13 [00:00<00:00, 966.88it/s] Downloading artifacts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 7/13 [00:00<00:00, 815.29it/s]Downloading artifacts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 8/13 [00:00<00:00, 267.23it/s]Downloading artifacts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 9/13 [00:00<00:00, 293.44it/s]Downloading artifacts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 10/13 [00:00<00:00, 287.33it/s]Downloading artifacts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 139.00it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 144.00it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00,  1.15s/it] Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00,  1.15s/it]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00,  1.15s/it]
"
2025-10-23 02:23:23.220369+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"Loads checkpoint by local backend from path: /tmp/tmp9b7d1gkl/checkpoint/model_final.pth
"
2025-10-23 02:23:24.534275+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"Making patches:   0%|          | 0/1 [00:00<?, ?it/s]Making patches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 9664.29it/s]
"
2025-10-23 02:23:26.324943+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"2025-10-23 02:23:26.320 | ERROR    | modint.runner.base_runner:inference:137 - An exception occurred:
"
2025-10-23 02:23:26.326508+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"Traceback (most recent call last):
"
2025-10-23 02:23:26.327420+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 02:23:26.328176+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    result = self.predict(data)
"
2025-10-23 02:23:26.329193+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 02:23:26.329963+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    return func(*args, **kwargs)
"
2025-10-23 02:23:26.334331+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 02:23:26.335594+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    return self.model.test_step(batch)
"
2025-10-23 02:23:26.336656+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 02:23:26.337825+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 02:23:26.338949+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 02:23:26.340108+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    results = self(**data, mode=mode)
"
2025-10-23 02:23:26.341532+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:23:26.342728+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:23:26.343825+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 02:23:26.345006+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    return self.predict(inputs, data_samples)
"
2025-10-23 02:23:26.346096+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 02:23:26.347257+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 02:23:26.348342+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 02:23:26.349549+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    x = self.backbone(batch_inputs)
"
2025-10-23 02:23:26.350623+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:23:26.351779+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:23:26.354746+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 02:23:26.356431+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    x = blk(x)
"
2025-10-23 02:23:26.357492+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:23:26.358810+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:23:26.360044+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 02:23:26.361006+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    x = self.attn(x)
"
2025-10-23 02:23:26.362148+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:23:26.363256+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:23:26.364464+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 02:23:26.365653+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 02:23:26.366621+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 02:23:26.367854+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 02:23:26.368937+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 02:23:26.369905+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"
"
2025-10-23 02:23:26.371007+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"[32m2025-10-23T02:23:26.320288+0000[0m [31m[1mAn exception occurred:
"
2025-10-23 02:23:26.372058+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"Traceback (most recent call last):
"
2025-10-23 02:23:26.373228+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 02:23:26.374340+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    result = self.predict(data)
"
2025-10-23 02:23:26.375549+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 02:23:26.376687+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    return func(*args, **kwargs)
"
2025-10-23 02:23:26.377607+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 02:23:26.378726+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    return self.model.test_step(batch)
"
2025-10-23 02:23:26.379742+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 02:23:26.380941+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 02:23:26.382044+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 02:23:26.383191+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    results = self(**data, mode=mode)
"
2025-10-23 02:23:26.384258+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:23:26.428332+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:23:26.429542+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 02:23:26.433341+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    return self.predict(inputs, data_samples)
"
2025-10-23 02:23:26.434220+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 02:23:26.435040+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 02:23:26.435793+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 02:23:26.436590+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    x = self.backbone(batch_inputs)
"
2025-10-23 02:23:26.437381+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:23:26.438202+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:23:26.439010+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 02:23:26.440310+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    x = blk(x)
"
2025-10-23 02:23:26.441594+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:23:26.442404+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:23:26.443386+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 02:23:26.444676+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    x = self.attn(x)
"
2025-10-23 02:23:26.445619+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:23:26.446419+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:23:26.447058+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 02:23:26.447647+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 02:23:26.448224+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 02:23:26.448829+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 02:23:26.449419+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 02:23:26.450465+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,"[0m
"
2025-10-23 02:23:38.681546+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e7-7908-b028-0cb36177616a,"{'msg': 'Traceback (most recent call last):\n  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference\n    result = self.predict(data)\n  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context\n    return func(*args, **kwargs)\n  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict\n    return self.model.test_step(batch)\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step\n    return self._run_forward(data, mode=\'predict\')  # type: ignore\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward\n    results = self(**data, mode=mode)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward\n    return self.predict(inputs, data_samples)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict\n    x = self.extract_feat(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat\n    x = self.backbone(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward\n    x = blk(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward\n    x = self.attn(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward\n    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos\n    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504\nRuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)\n', 'retriable': False}"
2025-10-23 02:23:38.694360+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e7-7908-b028-0cb36177616a,Inference was failed. See the logs for detail.
2025-10-23 02:23:38.696650+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e7-7908-b028-0cb36177616a,"Task run failed with exception: InferenceFailError() - No retries configured for this task.
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 02:23:38.713171+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e7-7908-b028-0cb36177616a,Finished in state Failed('Task run encountered an exception InferenceFailError: ')
2025-10-23 02:23:41.648315+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee0-15e5-707b-b0c6-c043f0ca05ca,Finished in state Completed()
2025-10-23 02:23:41.658268+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Encountered exception during execution: InferenceFailError()
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 02:23:41.713495+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Finished in state Failed('Flow run encountered an exception: InferenceFailError: ')
2025-10-23 02:23:41.716269+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Engine execution exited with unexpected exception
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1554, in run_flow
    ret_val = run_flow_sync(**kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1399, in run_flow_sync
    return engine.state if return_type == ""state"" else engine.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 361, in result
    raise self._raised
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 02:23:42.369464+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Process for flow run 'hilarious-gazelle' exited with status code: 1
2025-10-23 02:24:10.485246+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Worker 'KubernetesWorker a05e490e-9eac-4523-9166-1b04920e6d58' submitting flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 02:24:10.680505+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Creating Kubernetes job...
2025-10-23 02:24:10.897413+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Completed submission of flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 02:24:17.440497+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Opening process...
2025-10-23 02:24:20.185259+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,, > Running git_clone step...
2025-10-23 02:24:25.809212+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Beginning flow run 'hilarious-gazelle' for flow 'run-modint-flow'
2025-10-23 02:24:25.994159+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-baf4-7f91-982d-7148e1315b03,This job ID will be used - modint-prefect-hilarious-gazelle-13
2025-10-23 02:24:26.000271+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-baf4-7f91-982d-7148e1315b03,Finished in state Completed()
2025-10-23 02:24:26.465054+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-731a-9bd3-03a40efb2d08,Finished in state Completed()
2025-10-23 02:24:26.505798+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbc9-7de1-a7ae-d540a9d56477,{'scene_path': '/nas/Dataset/securewatch/geofocus/20240110_50cm_Hamju/050195143010_01/050195143010_01_P001_PSH/23NOV22020447-S2AS-050195143010_01_P001.TIF'}
2025-10-23 02:24:26.605595+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bdcf-74da-843e-cec56bad6e92,Finished in state Completed()
2025-10-23 02:24:27.494915+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,Beginning subflow run 'steadfast-toucan' for flow 'run-namespaced-job'
2025-10-23 02:24:35.676219+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"Downloading artifacts:   0%|          | 0/13 [00:00<?, ?it/s]2025/10/23 02:24:35 INFO mlflow.store.artifact.artifact_repo: The progress bar can be disabled by setting the environment variable MLFLOW_ENABLE_ARTIFACTS_PROGRESS_BAR to false
"
2025-10-23 02:25:15.746987+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"Loads checkpoint by local backend from path: /tmp/tmpood2oqpb/checkpoint/model_final.pth
"
2025-10-23 02:25:15.749206+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"Downloading artifacts:   8%|â–Š         | 1/13 [00:00<00:00, 798.15it/s]Downloading artifacts:  15%|â–ˆâ–Œ        | 2/13 [00:00<00:00, 854.85it/s]Downloading artifacts:  23%|â–ˆâ–ˆâ–Ž       | 3/13 [00:00<00:00, 876.98it/s]Downloading artifacts:  31%|â–ˆâ–ˆâ–ˆ       | 4/13 [00:00<00:00, 978.78it/s]Downloading artifacts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 5/13 [00:00<00:00, 1082.51it/s]Downloading artifacts:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 6/13 [00:00<00:00, 735.31it/s] Downloading artifacts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 7/13 [00:00<00:00, 824.56it/s]Downloading artifacts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 8/13 [00:00<00:00, 917.67it/s]Downloading artifacts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 9/13 [00:00<00:00, 725.74it/s]Downloading artifacts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 10/13 [00:00<00:00, 735.43it/s]Downloading artifacts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 589.78it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 124.04it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00,  1.11s/it] Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00,  1.11s/it]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:14<00:00,  1.11s/it]
"
2025-10-23 02:25:17.127086+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"Making patches:   0%|          | 0/1 [00:00<?, ?it/s]Making patches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 9532.51it/s]
"
2025-10-23 02:25:19.215504+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"2025-10-23 02:25:19.209 | ERROR    | modint.runner.base_runner:inference:137 - An exception occurred:
"
2025-10-23 02:25:19.217753+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"Traceback (most recent call last):
"
2025-10-23 02:25:19.220088+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 02:25:19.222355+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    result = self.predict(data)
"
2025-10-23 02:25:19.224508+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 02:25:19.226435+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    return func(*args, **kwargs)
"
2025-10-23 02:25:19.228326+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 02:25:19.230203+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    return self.model.test_step(batch)
"
2025-10-23 02:25:19.231853+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 02:25:19.233725+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 02:25:19.239146+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 02:25:19.240825+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    results = self(**data, mode=mode)
"
2025-10-23 02:25:19.242208+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:25:19.243872+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:25:19.248296+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 02:25:19.250323+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    return self.predict(inputs, data_samples)
"
2025-10-23 02:25:19.251985+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 02:25:19.253504+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 02:25:19.255250+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 02:25:19.256890+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    x = self.backbone(batch_inputs)
"
2025-10-23 02:25:19.258247+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:25:19.259842+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:25:19.261498+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 02:25:19.262911+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    x = blk(x)
"
2025-10-23 02:25:19.264494+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:25:19.266065+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:25:19.267316+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 02:25:19.268750+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    x = self.attn(x)
"
2025-10-23 02:25:19.270143+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:25:19.271368+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:25:19.272786+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 02:25:19.274158+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 02:25:19.275326+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 02:25:19.276767+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 02:25:19.278075+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 02:25:19.279188+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"
"
2025-10-23 02:25:19.280531+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"[32m2025-10-23T02:25:19.209847+0000[0m [31m[1mAn exception occurred:
"
2025-10-23 02:25:19.281847+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"Traceback (most recent call last):
"
2025-10-23 02:25:19.282919+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 02:25:19.284258+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    result = self.predict(data)
"
2025-10-23 02:25:19.285596+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 02:25:19.286681+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    return func(*args, **kwargs)
"
2025-10-23 02:25:19.287932+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 02:25:19.329098+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    return self.model.test_step(batch)
"
2025-10-23 02:25:19.331170+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 02:25:19.333121+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 02:25:19.335199+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 02:25:19.337286+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    results = self(**data, mode=mode)
"
2025-10-23 02:25:19.339623+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:25:19.341747+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:25:19.343893+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 02:25:19.345834+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    return self.predict(inputs, data_samples)
"
2025-10-23 02:25:19.347823+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 02:25:19.349652+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 02:25:19.351250+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 02:25:19.353230+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    x = self.backbone(batch_inputs)
"
2025-10-23 02:25:19.355027+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:25:19.356666+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:25:19.358300+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 02:25:19.359864+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    x = blk(x)
"
2025-10-23 02:25:19.361277+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:25:19.363078+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:25:19.364559+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 02:25:19.365931+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    x = self.attn(x)
"
2025-10-23 02:25:19.367567+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 02:25:19.368868+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    return forward_call(*input, **kwargs)
"
2025-10-23 02:25:19.370065+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 02:25:19.371659+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 02:25:19.372954+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 02:25:19.374275+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 02:25:19.375863+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 02:25:19.377301+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,"[0m
"
2025-10-23 02:25:26.579586+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbc9-7de1-a7ae-d540a9d56477,"{'msg': 'Traceback (most recent call last):\n  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference\n    result = self.predict(data)\n  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context\n    return func(*args, **kwargs)\n  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict\n    return self.model.test_step(batch)\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step\n    return self._run_forward(data, mode=\'predict\')  # type: ignore\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward\n    results = self(**data, mode=mode)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward\n    return self.predict(inputs, data_samples)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict\n    x = self.extract_feat(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat\n    x = self.backbone(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward\n    x = blk(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward\n    x = self.attn(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward\n    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos\n    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504\nRuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)\n', 'retriable': False}"
2025-10-23 02:25:26.586036+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbc9-7de1-a7ae-d540a9d56477,Inference was failed. See the logs for detail.
2025-10-23 02:25:26.588274+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbc9-7de1-a7ae-d540a9d56477,"Task run failed with exception: InferenceFailError() - No retries configured for this task.
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 02:25:26.604572+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbc9-7de1-a7ae-d540a9d56477,Finished in state Failed('Task run encountered an exception InferenceFailError: ')
2025-10-23 02:25:32.498423+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0ee1-bbaf-7a96-bea2-852dc9b16e5d,Finished in state Completed()
2025-10-23 02:25:32.512812+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Encountered exception during execution: InferenceFailError()
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 02:25:32.570215+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Finished in state Failed('Flow run encountered an exception: InferenceFailError: ')
2025-10-23 02:25:32.572892+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Engine execution exited with unexpected exception
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1554, in run_flow
    ret_val = run_flow_sync(**kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1399, in run_flow_sync
    return engine.state if return_type == ""state"" else engine.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 361, in result
    raise self._raised
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 02:25:33.157188+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Process for flow run 'hilarious-gazelle' exited with status code: 1
2025-10-23 04:38:54.320795+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Worker 'KubernetesWorker a05e490e-9eac-4523-9166-1b04920e6d58' submitting flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 04:38:54.490307+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Creating Kubernetes job...
2025-10-23 04:38:54.678507+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Completed submission of flow run 'af71fbbe-91e5-4519-9996-8aaa4a14c356'
2025-10-23 04:39:00.799084+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Opening process...
2025-10-23 04:39:03.524624+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,, > Running git_clone step...
2025-10-23 04:39:09.042459+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Beginning flow run 'hilarious-gazelle' for flow 'run-modint-flow'
2025-10-23 04:39:09.233888+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-1215-718a-a551-1fe223902559,This job ID will be used - modint-prefect-hilarious-gazelle-14
2025-10-23 04:39:09.240042+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-1215-718a-a551-1fe223902559,Finished in state Completed()
2025-10-23 04:39:09.762588+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-789a-917d-3ff54791033e,Finished in state Completed()
2025-10-23 04:39:09.805972+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bd-7789-b0d1-0a41f8799b2c,{'scene_path': '/nas/Dataset/securewatch/geofocus/20240110_50cm_Hamju/050195143010_01/050195143010_01_P001_PSH/23NOV22020447-S2AS-050195143010_01_P001.TIF'}
2025-10-23 04:39:09.900875+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-152e-7947-a416-af9312409b9a,Finished in state Completed()
2025-10-23 04:39:10.795968+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,Beginning subflow run 'steadfast-toucan' for flow 'run-namespaced-job'
2025-10-23 04:39:18.848514+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"Downloading artifacts:   0%|          | 0/13 [00:00<?, ?it/s]2025/10/23 04:39:18 INFO mlflow.store.artifact.artifact_repo: The progress bar can be disabled by setting the environment variable MLFLOW_ENABLE_ARTIFACTS_PROGRESS_BAR to false
"
2025-10-23 04:40:00.220491+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"Loads checkpoint by local backend from path: /tmp/tmp5efkbe_i/checkpoint/model_final.pth
"
2025-10-23 04:40:00.223111+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"Downloading artifacts:   8%|â–Š         | 1/13 [00:00<00:00, 349.67it/s]Downloading artifacts:  15%|â–ˆâ–Œ        | 2/13 [00:00<00:00, 625.69it/s]Downloading artifacts:  23%|â–ˆâ–ˆâ–Ž       | 3/13 [00:00<00:00, 861.31it/s]Downloading artifacts:  31%|â–ˆâ–ˆâ–ˆ       | 4/13 [00:00<00:00, 1070.86it/s]Downloading artifacts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 5/13 [00:00<00:00, 1255.25it/s]Downloading artifacts:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 6/13 [00:00<00:00, 498.43it/s] Downloading artifacts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 7/13 [00:00<00:00, 455.60it/s]Downloading artifacts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 8/13 [00:00<00:00, 343.06it/s]Downloading artifacts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 9/13 [00:00<00:00, 349.57it/s]Downloading artifacts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 10/13 [00:00<00:00, 373.04it/s]Downloading artifacts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 115.91it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 100.15it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 100.15it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:19<00:00, 100.15it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:20<00:00,  2.15s/it] Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:20<00:00,  2.15s/it]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:20<00:00,  1.56s/it]
"
2025-10-23 04:40:01.614680+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"Making patches:   0%|          | 0/1 [00:00<?, ?it/s]Making patches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 9446.63it/s]
"
2025-10-23 04:40:04.373436+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"2025-10-23 04:40:04.351 | ERROR    | modint.runner.base_runner:inference:137 - An exception occurred:
"
2025-10-23 04:40:04.375836+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"Traceback (most recent call last):
"
2025-10-23 04:40:04.379699+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 04:40:04.381592+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    result = self.predict(data)
"
2025-10-23 04:40:04.383741+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 04:40:04.386127+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    return func(*args, **kwargs)
"
2025-10-23 04:40:04.388299+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 04:40:04.390635+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    return self.model.test_step(batch)
"
2025-10-23 04:40:04.392758+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 04:40:04.394595+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 04:40:04.396289+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 04:40:04.398190+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    results = self(**data, mode=mode)
"
2025-10-23 04:40:04.400093+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 04:40:04.402393+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    return forward_call(*input, **kwargs)
"
2025-10-23 04:40:04.404733+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 04:40:04.407027+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    return self.predict(inputs, data_samples)
"
2025-10-23 04:40:04.408988+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 04:40:04.411175+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 04:40:04.413150+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 04:40:04.414847+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    x = self.backbone(batch_inputs)
"
2025-10-23 04:40:04.416725+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 04:40:04.418516+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    return forward_call(*input, **kwargs)
"
2025-10-23 04:40:04.420205+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 04:40:04.422094+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    x = blk(x)
"
2025-10-23 04:40:04.423616+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 04:40:04.424994+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    return forward_call(*input, **kwargs)
"
2025-10-23 04:40:04.426617+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 04:40:04.428215+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    x = self.attn(x)
"
2025-10-23 04:40:04.429603+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 04:40:04.431236+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    return forward_call(*input, **kwargs)
"
2025-10-23 04:40:04.432800+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 04:40:04.434091+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 04:40:04.435549+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 04:40:04.437026+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 04:40:04.438257+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 04:40:04.439766+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"
"
2025-10-23 04:40:04.441194+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"[32m2025-10-23T04:40:04.351882+0000[0m [31m[1mAn exception occurred:
"
2025-10-23 04:40:04.442492+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"Traceback (most recent call last):
"
2025-10-23 04:40:04.443818+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-10-23 04:40:04.445427+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    result = self.predict(data)
"
2025-10-23 04:40:04.446594+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-10-23 04:40:04.447952+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    return func(*args, **kwargs)
"
2025-10-23 04:40:04.449267+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-10-23 04:40:04.450366+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    return self.model.test_step(batch)
"
2025-10-23 04:40:04.451729+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-10-23 04:40:04.453053+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-10-23 04:40:04.454021+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-10-23 04:40:04.455189+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    results = self(**data, mode=mode)
"
2025-10-23 04:40:04.456295+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 04:40:04.457512+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    return forward_call(*input, **kwargs)
"
2025-10-23 04:40:04.458653+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-10-23 04:40:04.459662+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    return self.predict(inputs, data_samples)
"
2025-10-23 04:40:04.461526+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-10-23 04:40:04.462722+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    x = self.extract_feat(batch_inputs)
"
2025-10-23 04:40:04.463908+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-10-23 04:40:04.465084+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    x = self.backbone(batch_inputs)
"
2025-10-23 04:40:04.466248+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 04:40:04.467216+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    return forward_call(*input, **kwargs)
"
2025-10-23 04:40:04.468440+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-10-23 04:40:04.469634+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    x = blk(x)
"
2025-10-23 04:40:04.470574+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 04:40:04.471775+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    return forward_call(*input, **kwargs)
"
2025-10-23 04:40:04.472966+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-10-23 04:40:04.473840+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    x = self.attn(x)
"
2025-10-23 04:40:04.474568+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-10-23 04:40:04.475630+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    return forward_call(*input, **kwargs)
"
2025-10-23 04:40:04.476806+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-10-23 04:40:04.477910+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-10-23 04:40:04.478984+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-10-23 04:40:04.522951+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-10-23 04:40:04.525204+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-10-23 04:40:04.527597+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,"[0m
"
2025-10-23 04:40:09.892204+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bd-7789-b0d1-0a41f8799b2c,"{'msg': 'Traceback (most recent call last):\n  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference\n    result = self.predict(data)\n  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context\n    return func(*args, **kwargs)\n  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict\n    return self.model.test_step(batch)\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step\n    return self._run_forward(data, mode=\'predict\')  # type: ignore\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward\n    results = self(**data, mode=mode)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward\n    return self.predict(inputs, data_samples)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict\n    x = self.extract_feat(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat\n    x = self.backbone(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward\n    x = blk(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward\n    x = self.attn(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward\n    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos\n    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504\nRuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)\n', 'retriable': False}"
2025-10-23 04:40:09.898510+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bd-7789-b0d1-0a41f8799b2c,Inference was failed. See the logs for detail.
2025-10-23 04:40:09.900754+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bd-7789-b0d1-0a41f8799b2c,"Task run failed with exception: InferenceFailError() - No retries configured for this task.
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 04:40:09.930838+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bd-7789-b0d1-0a41f8799b2c,Finished in state Failed('Task run encountered an exception InferenceFailError: ')
2025-10-23 04:40:11.640329+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,019a0f5d-12bb-7ca5-83f1-531029683525,Finished in state Completed()
2025-10-23 04:40:11.650348+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Encountered exception during execution: InferenceFailError()
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 04:40:11.754693+00:00,20,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Finished in state Failed('Flow run encountered an exception: InferenceFailError: ')
2025-10-23 04:40:11.757622+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,"Engine execution exited with unexpected exception
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1554, in run_flow
    ret_val = run_flow_sync(**kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1399, in run_flow_sync
    return engine.state if return_type == ""state"" else engine.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 361, in result
    raise self._raised
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 528, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-10-23 04:40:12.469190+00:00,40,af71fbbe-91e5-4519-9996-8aaa4a14c356,,Process for flow run 'hilarious-gazelle' exited with status code: 1
