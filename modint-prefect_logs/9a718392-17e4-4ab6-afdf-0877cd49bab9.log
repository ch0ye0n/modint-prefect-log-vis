timestamp,level,flow_run_id,task_run_id,message
2025-09-26 06:53:28.863158+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,,Worker 'KubernetesWorker f57fee9f-462d-4274-a6ce-f98711af336a' submitting flow run '9a718392-17e4-4ab6-afdf-0877cd49bab9'
2025-09-26 06:53:29.056548+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,,Creating Kubernetes job...
2025-09-26 06:53:30.405137+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,,Completed submission of flow run '9a718392-17e4-4ab6-afdf-0877cd49bab9'
2025-09-26 06:53:35.786104+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,,Opening process...
2025-09-26 06:53:38.391857+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,, > Running git_clone step...
2025-09-26 06:53:44.231333+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,,Beginning flow run 'esoteric-quokka' for flow 'run-modint-flow'
2025-09-26 06:53:44.451773+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-95ca-761e-9ba5-e140972d2580,This job ID will be used - modint-prefect-esoteric-quokka-1
2025-09-26 06:53:44.457904+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-95ca-761e-9ba5-e140972d2580,Finished in state Completed()
2025-09-26 06:53:44.984555+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7b08-8d39-912754bb83a5,Finished in state Completed()
2025-09-26 06:53:45.061711+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968f-77c5-bfed-d3ce966b435c,{'scene_path': '/nas/Dataset/s3/sia_aws_s3/sia-geofocus/raw/G-PRS12A/skysat/ìž¥ì „í•­_250921_skysatcollect_pansharpened_udm2/SkySatCollect/20250921_060201_ssc6_u0001_pansharpened_clip.tif'}
2025-09-26 06:53:45.168845+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-992c-7164-938b-5d0e79403f1d,Finished in state Completed()
2025-09-26 06:53:46.223821+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,Beginning subflow run 'ochre-auk' for flow 'run-namespaced-job'
2025-09-26 06:54:44.597172+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"Downloading artifacts:   0%|          | 0/13 [00:00<?, ?it/s]Downloading artifacts:   8%|â–Š         | 1/13 [00:00<00:00, 3908.95it/s]Downloading artifacts:  15%|â–ˆâ–Œ        | 2/13 [00:00<00:00, 339.08it/s] Downloading artifacts:  23%|â–ˆâ–ˆâ–Ž       | 3/13 [00:00<00:00, 476.23it/s]Downloading artifacts:  31%|â–ˆâ–ˆâ–ˆ       | 4/13 [00:00<00:00, 476.08it/s]Downloading artifacts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 5/13 [00:00<00:00, 572.85it/s]Downloading artifacts:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 6/13 [00:00<00:00, 508.73it/s]Downloading artifacts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 7/13 [00:00<00:00, 444.67it/s]Downloading artifacts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 8/13 [00:00<00:00, 389.59it/s]Downloading artifacts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 9/13 [00:00<00:00, 420.75it/s]Downloading artifacts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 10/13 [00:00<00:00, 357.74it/s]Downloading artifacts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 252.94it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 143.10it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:15<00:00,  1.21s/it] Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:15<00:00,  1.21s/it]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:15<00:00,  1.21s/it]
"
2025-09-26 06:54:44.601194+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"Loads checkpoint by local backend from path: /tmp/tmpy17fqbps/checkpoint/model_final.pth
"
2025-09-26 06:54:44.807339+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"Making patches:   0%|          | 0/1 [00:00<?, ?it/s]Making patches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 111.76it/s]
"
2025-09-26 06:54:46.489270+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"2025-09-26 06:54:46.469 | ERROR    | modint.runner.base_runner:inference:137 - An exception occurred:
"
2025-09-26 06:54:46.491971+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"Traceback (most recent call last):
"
2025-09-26 06:54:46.496325+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-09-26 06:54:46.498402+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    result = self.predict(data)
"
2025-09-26 06:54:46.500725+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-09-26 06:54:46.503941+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    return func(*args, **kwargs)
"
2025-09-26 06:54:46.505789+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-09-26 06:54:46.508804+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    return self.model.test_step(batch)
"
2025-09-26 06:54:46.511196+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-09-26 06:54:46.512905+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-09-26 06:54:46.514907+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-09-26 06:54:46.517394+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    results = self(**data, mode=mode)
"
2025-09-26 06:54:46.519001+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-09-26 06:54:46.520779+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    return forward_call(*input, **kwargs)
"
2025-09-26 06:54:46.522558+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-09-26 06:54:46.524162+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    return self.predict(inputs, data_samples)
"
2025-09-26 06:54:46.525943+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-09-26 06:54:46.527575+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    x = self.extract_feat(batch_inputs)
"
2025-09-26 06:54:46.529546+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-09-26 06:54:46.531274+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    x = self.backbone(batch_inputs)
"
2025-09-26 06:54:46.532849+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-09-26 06:54:46.534679+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    return forward_call(*input, **kwargs)
"
2025-09-26 06:54:46.536286+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-09-26 06:54:46.537333+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    x = blk(x)
"
2025-09-26 06:54:46.538870+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-09-26 06:54:46.540405+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    return forward_call(*input, **kwargs)
"
2025-09-26 06:54:46.542069+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-09-26 06:54:46.543616+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    x = self.attn(x)
"
2025-09-26 06:54:46.544616+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-09-26 06:54:46.545611+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    return forward_call(*input, **kwargs)
"
2025-09-26 06:54:46.546469+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-09-26 06:54:46.547327+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-09-26 06:54:46.548184+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-09-26 06:54:46.549653+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-09-26 06:54:46.551242+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-09-26 06:54:46.552439+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"
"
2025-09-26 06:54:46.553810+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"[32m2025-09-26T06:54:46.469611+0000[0m [31m[1mAn exception occurred:
"
2025-09-26 06:54:46.555206+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"Traceback (most recent call last):
"
2025-09-26 06:54:46.556066+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-09-26 06:54:46.556800+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    result = self.predict(data)
"
2025-09-26 06:54:46.557536+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-09-26 06:54:46.558287+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    return func(*args, **kwargs)
"
2025-09-26 06:54:46.559006+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-09-26 06:54:46.559735+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    return self.model.test_step(batch)
"
2025-09-26 06:54:46.560458+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-09-26 06:54:46.561208+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-09-26 06:54:46.561939+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-09-26 06:54:46.562669+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    results = self(**data, mode=mode)
"
2025-09-26 06:54:46.563383+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-09-26 06:54:46.564110+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    return forward_call(*input, **kwargs)
"
2025-09-26 06:54:46.564831+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-09-26 06:54:46.565572+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    return self.predict(inputs, data_samples)
"
2025-09-26 06:54:46.566206+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-09-26 06:54:46.566847+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    x = self.extract_feat(batch_inputs)
"
2025-09-26 06:54:46.567433+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-09-26 06:54:46.568015+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    x = self.backbone(batch_inputs)
"
2025-09-26 06:54:46.568587+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-09-26 06:54:46.569219+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    return forward_call(*input, **kwargs)
"
2025-09-26 06:54:46.569813+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-09-26 06:54:46.570411+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    x = blk(x)
"
2025-09-26 06:54:46.570989+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-09-26 06:54:46.571584+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    return forward_call(*input, **kwargs)
"
2025-09-26 06:54:46.572167+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-09-26 06:54:46.572758+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    x = self.attn(x)
"
2025-09-26 06:54:46.573550+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-09-26 06:54:46.574214+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    return forward_call(*input, **kwargs)
"
2025-09-26 06:54:46.574851+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-09-26 06:54:46.575498+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-09-26 06:54:46.576135+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-09-26 06:54:46.576771+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-09-26 06:54:46.621367+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-09-26 06:54:46.623358+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,"[0m
"
2025-09-26 06:54:53.811227+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968d-7fe7-81a2-ef5d31788d10,Finished in state Completed()
2025-09-26 06:55:15.165770+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968f-77c5-bfed-d3ce966b435c,"{'msg': 'Traceback (most recent call last):\n  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference\n    result = self.predict(data)\n  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context\n    return func(*args, **kwargs)\n  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict\n    return self.model.test_step(batch)\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step\n    return self._run_forward(data, mode=\'predict\')  # type: ignore\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward\n    results = self(**data, mode=mode)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward\n    return self.predict(inputs, data_samples)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict\n    x = self.extract_feat(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat\n    x = self.backbone(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward\n    x = blk(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward\n    x = self.attn(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward\n    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos\n    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504\nRuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)\n', 'retriable': False}"
2025-09-26 06:55:15.172276+00:00,40,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968f-77c5-bfed-d3ce966b435c,Inference was failed. See the logs for detail.
2025-09-26 06:55:15.174472+00:00,40,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968f-77c5-bfed-d3ce966b435c,"Task run failed with exception: InferenceFailError() - No retries configured for this task.
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-09-26 06:55:15.189365+00:00,40,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984cc-968f-77c5-bfed-d3ce966b435c,Finished in state Failed('Task run encountered an exception InferenceFailError: ')
2025-09-26 06:55:15.199681+00:00,40,9a718392-17e4-4ab6-afdf-0877cd49bab9,,"Encountered exception during execution: InferenceFailError()
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 530, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-09-26 06:55:15.258222+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,,Finished in state Failed('Flow run encountered an exception: InferenceFailError: ')
2025-09-26 06:55:15.260857+00:00,40,9a718392-17e4-4ab6-afdf-0877cd49bab9,,"Engine execution exited with unexpected exception
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1554, in run_flow
    ret_val = run_flow_sync(**kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1399, in run_flow_sync
    return engine.state if return_type == ""state"" else engine.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 361, in result
    raise self._raised
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 530, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-09-26 06:55:15.944676+00:00,40,9a718392-17e4-4ab6-afdf-0877cd49bab9,,Process for flow run 'esoteric-quokka' exited with status code: 1
2025-09-26 06:57:55.781759+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,,Worker 'KubernetesWorker f57fee9f-462d-4274-a6ce-f98711af336a' submitting flow run '9a718392-17e4-4ab6-afdf-0877cd49bab9'
2025-09-26 06:57:55.966589+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,,Creating Kubernetes job...
2025-09-26 06:57:57.115555+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,,Completed submission of flow run '9a718392-17e4-4ab6-afdf-0877cd49bab9'
2025-09-26 06:58:02.666901+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,,Opening process...
2025-09-26 06:58:05.423022+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,, > Running git_clone step...
2025-09-26 06:58:11.559461+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,,Beginning flow run 'esoteric-quokka' for flow 'run-modint-flow'
2025-09-26 06:58:11.753972+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aa0b-7f1a-b876-34274d4e4f1a,This job ID will be used - modint-prefect-esoteric-quokka-2
2025-09-26 06:58:11.759673+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aa0b-7f1a-b876-34274d4e4f1a,Finished in state Completed()
2025-09-26 06:58:12.236243+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab2-7f57-8f98-6a4e5360f9d8,Finished in state Completed()
2025-09-26 06:58:12.280929+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab4-7e86-8de7-e732fde50791,{'scene_path': '/nas/Dataset/s3/sia_aws_s3/sia-geofocus/raw/G-PRS12A/skysat/ìž¥ì „í•­_250921_skysatcollect_pansharpened_udm2/SkySatCollect/20250921_060201_ssc6_u0001_pansharpened_clip.tif'}
2025-09-26 06:58:12.391043+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-ad06-74ab-9948-35618f38f3d0,Finished in state Completed()
2025-09-26 06:58:13.261525+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,Beginning subflow run 'ochre-auk' for flow 'run-namespaced-job'
2025-09-26 06:59:20.831743+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"Downloading artifacts:   0%|          | 0/13 [00:00<?, ?it/s]Downloading artifacts:   8%|â–Š         | 1/13 [00:00<00:00, 5433.04it/s]Downloading artifacts:  15%|â–ˆâ–Œ        | 2/13 [00:00<00:00, 438.02it/s] Downloading artifacts:  23%|â–ˆâ–ˆâ–Ž       | 3/13 [00:00<00:00, 507.36it/s]Downloading artifacts:  31%|â–ˆâ–ˆâ–ˆ       | 4/13 [00:00<00:00, 363.56it/s]Downloading artifacts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 5/13 [00:00<00:00, 282.64it/s]Downloading artifacts:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 6/13 [00:00<00:00, 155.71it/s]Downloading artifacts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 7/13 [00:00<00:00, 143.73it/s]Downloading artifacts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 8/13 [00:00<00:00, 154.25it/s]Downloading artifacts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 9/13 [00:00<00:00, 160.12it/s]Downloading artifacts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 10/13 [00:00<00:00, 156.46it/s]Downloading artifacts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 89.55it/s] Downloading artifacts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 89.55it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 89.55it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:15<00:00, 89.55it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:15<00:00,  1.22s/it]
"
2025-09-26 06:59:20.836499+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"Loads checkpoint by local backend from path: /tmp/tmpbcw6nr7b/checkpoint/model_final.pth
"
2025-09-26 06:59:21.064664+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"Making patches:   0%|          | 0/1 [00:00<?, ?it/s]Making patches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 151.23it/s]
"
2025-09-26 06:59:22.445473+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"2025-09-26 06:59:22.428 | ERROR    | modint.runner.base_runner:inference:137 - An exception occurred:
"
2025-09-26 06:59:22.448493+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"Traceback (most recent call last):
"
2025-09-26 06:59:22.451434+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-09-26 06:59:22.453560+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    result = self.predict(data)
"
2025-09-26 06:59:22.455880+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-09-26 06:59:22.458059+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    return func(*args, **kwargs)
"
2025-09-26 06:59:22.460006+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-09-26 06:59:22.462553+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    return self.model.test_step(batch)
"
2025-09-26 06:59:22.464121+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-09-26 06:59:22.466438+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-09-26 06:59:22.468014+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-09-26 06:59:22.470282+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    results = self(**data, mode=mode)
"
2025-09-26 06:59:22.471825+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-09-26 06:59:22.473618+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    return forward_call(*input, **kwargs)
"
2025-09-26 06:59:22.475334+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-09-26 06:59:22.476749+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    return self.predict(inputs, data_samples)
"
2025-09-26 06:59:22.478473+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-09-26 06:59:22.480072+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    x = self.extract_feat(batch_inputs)
"
2025-09-26 06:59:22.481520+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-09-26 06:59:22.486670+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    x = self.backbone(batch_inputs)
"
2025-09-26 06:59:22.488223+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-09-26 06:59:22.489553+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    return forward_call(*input, **kwargs)
"
2025-09-26 06:59:22.490814+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-09-26 06:59:22.491826+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    x = blk(x)
"
2025-09-26 06:59:22.493422+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-09-26 06:59:22.494772+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    return forward_call(*input, **kwargs)
"
2025-09-26 06:59:22.496063+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-09-26 06:59:22.497639+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    x = self.attn(x)
"
2025-09-26 06:59:22.498996+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-09-26 06:59:22.500329+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    return forward_call(*input, **kwargs)
"
2025-09-26 06:59:22.501966+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-09-26 06:59:22.503338+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-09-26 06:59:22.504298+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-09-26 06:59:22.505469+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-09-26 06:59:22.506928+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-09-26 06:59:22.517807+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"
"
2025-09-26 06:59:22.519382+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"[32m2025-09-26T06:59:22.428102+0000[0m [31m[1mAn exception occurred:
"
2025-09-26 06:59:22.520834+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"Traceback (most recent call last):
"
2025-09-26 06:59:22.522528+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-09-26 06:59:22.524399+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    result = self.predict(data)
"
2025-09-26 06:59:22.526158+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-09-26 06:59:22.528284+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    return func(*args, **kwargs)
"
2025-09-26 06:59:22.530305+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-09-26 06:59:22.532058+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    return self.model.test_step(batch)
"
2025-09-26 06:59:22.533997+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-09-26 06:59:22.535767+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-09-26 06:59:22.537337+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-09-26 06:59:22.539162+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    results = self(**data, mode=mode)
"
2025-09-26 06:59:22.540857+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-09-26 06:59:22.542492+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    return forward_call(*input, **kwargs)
"
2025-09-26 06:59:22.544124+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-09-26 06:59:22.545678+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    return self.predict(inputs, data_samples)
"
2025-09-26 06:59:22.547011+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-09-26 06:59:22.548561+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    x = self.extract_feat(batch_inputs)
"
2025-09-26 06:59:22.550072+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-09-26 06:59:22.551341+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    x = self.backbone(batch_inputs)
"
2025-09-26 06:59:22.552827+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-09-26 06:59:22.554268+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    return forward_call(*input, **kwargs)
"
2025-09-26 06:59:22.555647+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-09-26 06:59:22.556984+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    x = blk(x)
"
2025-09-26 06:59:22.558312+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-09-26 06:59:22.559755+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    return forward_call(*input, **kwargs)
"
2025-09-26 06:59:22.561136+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-09-26 06:59:22.562262+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    x = self.attn(x)
"
2025-09-26 06:59:22.563595+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-09-26 06:59:22.564862+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    return forward_call(*input, **kwargs)
"
2025-09-26 06:59:22.565932+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-09-26 06:59:22.567228+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-09-26 06:59:22.568501+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-09-26 06:59:22.569522+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-09-26 06:59:22.570322+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-09-26 06:59:22.571582+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,"[0m
"
2025-09-26 06:59:29.771724+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab3-73d7-ba29-f75e69ec1e68,Finished in state Completed()
2025-09-26 06:59:42.397162+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab4-7e86-8de7-e732fde50791,"{'msg': 'Traceback (most recent call last):\n  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference\n    result = self.predict(data)\n  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context\n    return func(*args, **kwargs)\n  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict\n    return self.model.test_step(batch)\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step\n    return self._run_forward(data, mode=\'predict\')  # type: ignore\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward\n    results = self(**data, mode=mode)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward\n    return self.predict(inputs, data_samples)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict\n    x = self.extract_feat(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat\n    x = self.backbone(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward\n    x = blk(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward\n    x = self.attn(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward\n    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos\n    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504\nRuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)\n', 'retriable': False}"
2025-09-26 06:59:42.403916+00:00,40,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab4-7e86-8de7-e732fde50791,Inference was failed. See the logs for detail.
2025-09-26 06:59:42.406166+00:00,40,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab4-7e86-8de7-e732fde50791,"Task run failed with exception: InferenceFailError() - No retries configured for this task.
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-09-26 06:59:42.421850+00:00,40,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d0-aab4-7e86-8de7-e732fde50791,Finished in state Failed('Task run encountered an exception InferenceFailError: ')
2025-09-26 06:59:42.431863+00:00,40,9a718392-17e4-4ab6-afdf-0877cd49bab9,,"Encountered exception during execution: InferenceFailError()
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 530, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-09-26 06:59:42.499828+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,,Finished in state Failed('Flow run encountered an exception: InferenceFailError: ')
2025-09-26 06:59:42.502588+00:00,40,9a718392-17e4-4ab6-afdf-0877cd49bab9,,"Engine execution exited with unexpected exception
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1554, in run_flow
    ret_val = run_flow_sync(**kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1399, in run_flow_sync
    return engine.state if return_type == ""state"" else engine.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 361, in result
    raise self._raised
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 530, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-09-26 06:59:43.281455+00:00,40,9a718392-17e4-4ab6-afdf-0877cd49bab9,,Process for flow run 'esoteric-quokka' exited with status code: 1
2025-09-26 07:01:25.981612+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,,Worker 'KubernetesWorker f57fee9f-462d-4274-a6ce-f98711af336a' submitting flow run '9a718392-17e4-4ab6-afdf-0877cd49bab9'
2025-09-26 07:01:26.167750+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,,Creating Kubernetes job...
2025-09-26 07:01:27.567381+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,,Completed submission of flow run '9a718392-17e4-4ab6-afdf-0877cd49bab9'
2025-09-26 07:01:33.122584+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,,Opening process...
2025-09-26 07:01:35.646583+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,, > Running git_clone step...
2025-09-26 07:01:41.315095+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,,Beginning flow run 'esoteric-quokka' for flow 'run-modint-flow'
2025-09-26 07:01:41.554458+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-dd68-72c6-8a50-bf0c0cc292d8,This job ID will be used - modint-prefect-esoteric-quokka-3
2025-09-26 07:01:41.561139+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-dd68-72c6-8a50-bf0c0cc292d8,Finished in state Completed()
2025-09-26 07:01:42.093136+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3c-7415-b866-3434381996e5,Finished in state Completed()
2025-09-26 07:01:42.159863+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3f-7438-8f33-18755c0bde00,{'scene_path': '/nas/Dataset/s3/sia_aws_s3/sia-geofocus/raw/G-PRS12A/skysat/ìž¥ì „í•­_250921_skysatcollect_pansharpened_udm2/SkySatCollect/20250921_060201_ssc6_u0001_pansharpened_clip.tif'}
2025-09-26 07:01:42.258602+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-e0cb-7b90-b86c-2bd1710ab8bf,Finished in state Completed()
2025-09-26 07:01:43.385878+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,Beginning subflow run 'ochre-auk' for flow 'run-namespaced-job'
2025-09-26 07:02:30.051765+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"Loads checkpoint by local backend from path: /tmp/tmpw_n3id12/checkpoint/model_final.pth
"
2025-09-26 07:02:30.054387+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"Downloading artifacts:   0%|          | 0/13 [00:00<?, ?it/s]Downloading artifacts:   8%|â–Š         | 1/13 [00:00<00:00, 5165.40it/s]Downloading artifacts:  15%|â–ˆâ–Œ        | 2/13 [00:00<00:00, 1853.84it/s]Downloading artifacts:  23%|â–ˆâ–ˆâ–Ž       | 3/13 [00:00<00:00, 2228.25it/s]Downloading artifacts:  31%|â–ˆâ–ˆâ–ˆ       | 4/13 [00:00<00:00, 1777.62it/s]Downloading artifacts:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 5/13 [00:00<00:00, 1638.78it/s]Downloading artifacts:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 6/13 [00:00<00:00, 1109.51it/s]Downloading artifacts:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 7/13 [00:00<00:00, 1118.18it/s]Downloading artifacts:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 8/13 [00:00<00:00, 1227.35it/s]Downloading artifacts:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 9/13 [00:00<00:00, 1335.15it/s]Downloading artifacts:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 10/13 [00:00<00:00, 166.93it/s]Downloading artifacts:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 11/13 [00:00<00:00, 170.61it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 104.32it/s]Downloading artifacts:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 12/13 [00:00<00:00, 104.32it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:15<00:00, 104.32it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 13/13 [00:15<00:00,  1.20s/it] 
"
2025-09-26 07:02:30.353267+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"Making patches:   0%|          | 0/1 [00:00<?, ?it/s]Making patches: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 233.98it/s]
"
2025-09-26 07:02:31.823339+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"2025-09-26 07:02:31.803 | ERROR    | modint.runner.base_runner:inference:137 - An exception occurred:
"
2025-09-26 07:02:31.826057+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"Traceback (most recent call last):
"
2025-09-26 07:02:31.828156+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-09-26 07:02:31.830480+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    result = self.predict(data)
"
2025-09-26 07:02:31.833001+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-09-26 07:02:31.835356+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    return func(*args, **kwargs)
"
2025-09-26 07:02:31.837508+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-09-26 07:02:31.839385+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    return self.model.test_step(batch)
"
2025-09-26 07:02:31.841687+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-09-26 07:02:31.843576+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-09-26 07:02:31.845639+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-09-26 07:02:31.848222+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    results = self(**data, mode=mode)
"
2025-09-26 07:02:31.850256+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-09-26 07:02:31.852051+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    return forward_call(*input, **kwargs)
"
2025-09-26 07:02:31.853467+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-09-26 07:02:31.855196+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    return self.predict(inputs, data_samples)
"
2025-09-26 07:02:31.856800+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-09-26 07:02:31.858226+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    x = self.extract_feat(batch_inputs)
"
2025-09-26 07:02:31.859927+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-09-26 07:02:31.861566+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    x = self.backbone(batch_inputs)
"
2025-09-26 07:02:31.862886+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-09-26 07:02:31.864375+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    return forward_call(*input, **kwargs)
"
2025-09-26 07:02:31.865804+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-09-26 07:02:31.867028+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    x = blk(x)
"
2025-09-26 07:02:31.868474+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-09-26 07:02:31.869920+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    return forward_call(*input, **kwargs)
"
2025-09-26 07:02:31.872784+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-09-26 07:02:31.874119+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    x = self.attn(x)
"
2025-09-26 07:02:31.875162+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-09-26 07:02:31.876989+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    return forward_call(*input, **kwargs)
"
2025-09-26 07:02:31.878264+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-09-26 07:02:31.879669+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-09-26 07:02:31.880998+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-09-26 07:02:31.881913+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-09-26 07:02:31.882761+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-09-26 07:02:31.883645+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"
"
2025-09-26 07:02:31.884469+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"[32m2025-09-26T07:02:31.803386+0000[0m [31m[1mAn exception occurred:
"
2025-09-26 07:02:31.918956+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"Traceback (most recent call last):
"
2025-09-26 07:02:31.921695+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference
"
2025-09-26 07:02:31.923592+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    result = self.predict(data)
"
2025-09-26 07:02:31.925369+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context
"
2025-09-26 07:02:31.928046+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    return func(*args, **kwargs)
"
2025-09-26 07:02:31.930300+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict
"
2025-09-26 07:02:31.932470+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    return self.model.test_step(batch)
"
2025-09-26 07:02:31.934186+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step
"
2025-09-26 07:02:31.936145+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    return self._run_forward(data, mode='predict')  # type: ignore
"
2025-09-26 07:02:31.938029+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward
"
2025-09-26 07:02:31.940060+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    results = self(**data, mode=mode)
"
2025-09-26 07:02:31.941970+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-09-26 07:02:31.943885+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    return forward_call(*input, **kwargs)
"
2025-09-26 07:02:31.945656+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward
"
2025-09-26 07:02:31.947517+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    return self.predict(inputs, data_samples)
"
2025-09-26 07:02:31.949277+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict
"
2025-09-26 07:02:31.950815+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    x = self.extract_feat(batch_inputs)
"
2025-09-26 07:02:31.952566+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat
"
2025-09-26 07:02:31.954160+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    x = self.backbone(batch_inputs)
"
2025-09-26 07:02:31.955256+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-09-26 07:02:31.956310+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    return forward_call(*input, **kwargs)
"
2025-09-26 07:02:31.957366+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward
"
2025-09-26 07:02:31.958744+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    x = blk(x)
"
2025-09-26 07:02:31.960339+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-09-26 07:02:31.961923+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    return forward_call(*input, **kwargs)
"
2025-09-26 07:02:31.963307+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward
"
2025-09-26 07:02:31.964746+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    x = self.attn(x)
"
2025-09-26 07:02:31.966188+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl
"
2025-09-26 07:02:31.967178+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    return forward_call(*input, **kwargs)
"
2025-09-26 07:02:31.968058+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward
"
2025-09-26 07:02:31.968950+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,
"
2025-09-26 07:02:31.969873+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos
"
2025-09-26 07:02:31.970773+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504
"
2025-09-26 07:02:31.971668+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"RuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)
"
2025-09-26 07:02:31.972601+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,"[0m
"
2025-09-26 07:02:39.123220+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3d-71aa-97cc-3072ae3b715b,Finished in state Completed()
2025-09-26 07:02:42.204925+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3f-7438-8f33-18755c0bde00,"{'msg': 'Traceback (most recent call last):\n  File ""/usr/local/lib/python3.8/site-packages/modint/runner/base_runner.py"", line 121, in inference\n    result = self.predict(data)\n  File ""/usr/local/lib/python3.8/site-packages/torch/autograd/grad_mode.py"", line 28, in decorate_context\n    return func(*args, **kwargs)\n  File ""/ardet/ardet/apis/det_runner.py"", line 99, in predict\n    return self.model.test_step(batch)\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 145, in test_step\n    return self._run_forward(data, mode=\'predict\')  # type: ignore\n  File ""/usr/local/lib/python3.8/site-packages/mmengine/model/base_model/base_model.py"", line 361, in _run_forward\n    results = self(**data, mode=mode)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/base.py"", line 94, in forward\n    return self.predict(inputs, data_samples)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 227, in predict\n    x = self.extract_feat(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/mmdet/models/detectors/two_stage.py"", line 110, in extract_feat\n    x = self.backbone(batch_inputs)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 423, in forward\n    x = blk(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 303, in forward\n    x = self.attn(x)\n  File ""/usr/local/lib/python3.8/site-packages/torch/nn/modules/module.py"", line 1051, in _call_impl\n    return forward_call(*input, **kwargs)\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 209, in forward\n    attn = add_decomposed_rel_pos(attn, q, self.rel_pos_h,\n  File ""/ardet/ardet/models/backbones/vitdet.py"", line 166, in add_decomposed_rel_pos\n    attn.view(B, q_h, q_w, k_h, k_w) +  # noqa: W504\nRuntimeError: CUDA out of memory. Tried to allocate 3.80 GiB (GPU 0; 10.76 GiB total capacity; 9.15 GiB already allocated; 201.38 MiB free; 9.22 GiB reserved in total by PyTorch)\n', 'retriable': False}"
2025-09-26 07:02:42.212054+00:00,40,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3f-7438-8f33-18755c0bde00,Inference was failed. See the logs for detail.
2025-09-26 07:02:42.214980+00:00,40,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3f-7438-8f33-18755c0bde00,"Task run failed with exception: InferenceFailError() - No retries configured for this task.
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-09-26 07:02:42.231263+00:00,40,9a718392-17e4-4ab6-afdf-0877cd49bab9,019984d3-de3f-7438-8f33-18755c0bde00,Finished in state Failed('Task run encountered an exception InferenceFailError: ')
2025-09-26 07:02:42.242458+00:00,40,9a718392-17e4-4ab6-afdf-0877cd49bab9,,"Encountered exception during execution: InferenceFailError()
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 530, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-09-26 07:02:42.332302+00:00,20,9a718392-17e4-4ab6-afdf-0877cd49bab9,,Finished in state Failed('Flow run encountered an exception: InferenceFailError: ')
2025-09-26 07:02:42.335788+00:00,40,9a718392-17e4-4ab6-afdf-0877cd49bab9,,"Engine execution exited with unexpected exception
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1554, in run_flow
    ret_val = run_flow_sync(**kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1399, in run_flow_sync
    return engine.state if return_type == ""state"" else engine.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 361, in result
    raise self._raised
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 782, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 1397, in run_flow_sync
    engine.call_flow_fn()
  File ""/usr/local/lib/python3.10/site-packages/prefect/flow_engine.py"", line 802, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 530, in run_modint_flow
    inference_result = check_inference_status_future.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/futures.py"", line 222, in result
    _result = self._final_state.result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/compatibility/async_dispatch.py"", line 94, in wrapper
    return fn(*args, **kwargs)
  File ""/usr/local/lib/python3.10/site-packages/prefect/client/schemas/objects.py"", line 366, in result
    return run_coro_as_sync(
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 207, in run_coro_as_sync
    return call.result()
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 365, in result
    return self.future.result(timeout=timeout)
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 192, in result
    return self.__get_result()
  File ""/usr/local/lib/python3.10/concurrent/futures/_base.py"", line 403, in __get_result
    raise self._exception
  File ""/usr/local/lib/python3.10/site-packages/prefect/_internal/concurrency/calls.py"", line 441, in _run_async
    result = await coro
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/asyncutils.py"", line 188, in coroutine_wrapper
    return await task
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 85, in get_state_result
    return await _get_state_result(
  File ""/usr/local/lib/python3.10/site-packages/prefect/states.py"", line 157, in _get_state_result
    raise await get_state_exception(state)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 857, in run_context
    yield self
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 1487, in run_task_sync
    engine.call_task_fn(txn)
  File ""/usr/local/lib/python3.10/site-packages/prefect/task_engine.py"", line 874, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
  File ""/usr/local/lib/python3.10/site-packages/prefect/utilities/callables.py"", line 210, in call_with_parameters
    return fn(*args, **kwargs)
  File ""/app/modint-prefect-main/modint_prefect/prefect_flow.py"", line 135, in run_check_inference_status_redis
    raise InferenceFailError
modint_prefect.configs.InferenceFailError"
2025-09-26 07:02:43.495387+00:00,40,9a718392-17e4-4ab6-afdf-0877cd49bab9,,Process for flow run 'esoteric-quokka' exited with status code: 1
